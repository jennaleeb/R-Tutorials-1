<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Tutorial 8 - ANCOVA &middot; R
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/poole.css">
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/syntax.css">
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/hyde.css">
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/custom.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/R-Tutorials-1public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/R-Tutorials-1public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <!-- Mathjax -->
  <script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    
    <!--Disqus comment counts-->
    <script id="dsq-count-scr" src="//MIE1402.disqus.com/count.js" async></script>
    
</head>


  <body class="theme-base-0b">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/R-Tutorials-1">
          R
        </a>
      </h1>
      <p class="lead">Content for MIE 1402 tutorials</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/R-Tutorials-1">Home</a>

      

      
      
        
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/R-Tutorials-1/about.html">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/R-Tutorials-1/archive.html">Archives</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/R-Tutorials-1/categories.html">Categories</a>
          
        
      
        
          
        
      
      <a class="sidebar-nav-item" href="https://github.com/jennaleeb/R-Tutorials-1">GitHub project</a>
    </nav>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Tutorial 8 - ANCOVA</h1>
  <span class="post-date">07 Nov 2016</span>
  <h2 id="analysis-of-covariance-ancova">Analysis of Covariance (ANCOVA)</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 8<br />
   MIE 1402</p>

<hr />

<h2 id="introduction">Introduction</h2>

<ul>
  <li>We can extend the regression equation for ANOVA to include continuous variable(s) that predict the outcome variable</li>
  <li>
    <p>These <em>continuous</em> variables that are NOT part of the experimental manipulation (but can influence the outcome) is called a covariate</p>
  </li>
  <li>Dealing with covariates relatively simple:
    <ul>
      <li>Enter the variable into regression model first (hierarchical)</li>
      <li>Then, enter the dummy variables representing the experimental manipulation</li>
    </ul>
  </li>
  <li>Voila! Now we can see the effect of the experiment after the covariate(s) have been accounted for</li>
</ul>

<hr />

<h2 id="reasons-for-including-covariates">Reasons for including covariates</h2>

<p><strong>1. Reduce within-group error variance</strong></p>

<ul>
  <li>Explain some of the ‘unexplained’ variance (<script type="math/tex">SS_{R}</script>)</li>
</ul>

<p><strong>2. Elimination of confounds</strong></p>

<ul>
  <li>Remove bias of any variable that is known to influence the dependent variable</li>
</ul>

<hr />

<h2 id="assumptions-of-ancova">Assumptions of ANCOVA</h2>

<p>Same as ANOVA, plus:</p>

<p><strong>1. Independence of covariate and treatment effect</strong></p>

<ul>
  <li>if the covariate is to explain some of the <script type="math/tex">SS_{R}</script>, it must be independent of the experimental effect</li>
  <li>variance explained by treatment &amp; covariate should not overlap
    <ul>
      <li>covariate will (statiscally speaking) reduce the experimental effect!</li>
    </ul>
  </li>
  <li>problem can be avoided by randomizing participants, or matching experimental groups on the covariate</li>
  <li>to evaluate, run a t-test (or anova if &gt; 2) to see if the groups differ significantly on levels of the covariate</li>
</ul>

<hr />

<h2 id="example-mtcars">Example: mtcars</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">kable</span><span class="p">(</span><span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s2">"am"</span><span class="p">,</span><span class="s2">"mpg"</span><span class="p">,</span><span class="s2">"hp"</span><span class="p">)]))</span><span class="w">
</span></code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: right">am</th>
      <th style="text-align: right">mpg</th>
      <th style="text-align: right">hp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Mazda RX4</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">21.0</td>
      <td style="text-align: right">110</td>
    </tr>
    <tr>
      <td style="text-align: left">Mazda RX4 Wag</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">21.0</td>
      <td style="text-align: right">110</td>
    </tr>
    <tr>
      <td style="text-align: left">Datsun 710</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">22.8</td>
      <td style="text-align: right">93</td>
    </tr>
    <tr>
      <td style="text-align: left">Hornet 4 Drive</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">21.4</td>
      <td style="text-align: right">110</td>
    </tr>
    <tr>
      <td style="text-align: left">Hornet Sportabout</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">18.7</td>
      <td style="text-align: right">175</td>
    </tr>
    <tr>
      <td style="text-align: left">Valiant</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">18.1</td>
      <td style="text-align: right">105</td>
    </tr>
  </tbody>
</table>

<p><em>Note</em><br />
<strong>am:</strong> type of transmission (auto or manual)<br />
<strong>mpg:</strong> miles per gallon<br />
<strong>hp:</strong> horsepower</p>

<hr />

<p><img src="/R-Tutorials-1/figure/source/2016-11-09-tutorial-8-ancova/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4" /></p>

<p><script type="math/tex">r_{hp,mpg}</script> = -0.7761684</p>

<hr />

<h2 id="assumption-1">Assumption 1</h2>

<p>Run a t-test to see if groups differ significantly on covariate</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="p">)</span><span class="w">
</span><span class="n">t.test</span><span class="p">(</span><span class="n">mtcars</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">,]</span><span class="o">$</span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,]</span><span class="o">$</span><span class="n">hp</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## 	Welch Two Sample t-test
## 
## data:  mtcars[mtcars$am == 0, ]$hp and mtcars[mtcars$am == 1, ]$hp
## t = 1.2662, df = 18.715, p-value = 0.221
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -21.87858  88.71259
## sample estimates:
## mean of x mean of y 
##  160.2632  126.8462
</code></pre>
</div>

<hr />

<h2 id="assumptions-of-ancova-1">Assumptions of ANCOVA</h2>

<p><strong>2. Homogeneity of Regression Slopes</strong></p>

<ul>
  <li>the slope of the regression line should be approximately the same in all groups</li>
  <li>i.e. relationship between covariate and outcome variable should not differ significantly between groups</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">leveneTest</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Levene's Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  1  0.1842 0.6709
##       30
</code></pre>
</div>

<hr />

<h2 id="running-the-ancova-analysis">Running the ANCOVA Analysis</h2>

<ul>
  <li>Recall: we want to study the effect of <strong>am</strong> on <strong>mpg</strong>, taking into account the covariate <strong>hp</strong></li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">result.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">hp</span><span class="o">+</span><span class="n">am</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">summary.lm</span><span class="p">(</span><span class="n">result.1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## aov(formula = mpg ~ hp + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3843 -2.2642  0.1366  1.6968  5.8657 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 26.584914   1.425094  18.655  &lt; 2e-16 ***
## hp          -0.058888   0.007857  -7.495 2.92e-08 ***
## am1          5.277085   1.079541   4.888 3.46e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.909 on 29 degrees of freedom
## Multiple R-squared:  0.782,	Adjusted R-squared:  0.767 
## F-statistic: 52.02 on 2 and 29 DF,  p-value: 2.55e-10
</code></pre>
</div>

<hr />

<h3 id="what-does-it-look-like-if-we-dont-include-the-covariate">What does it look like if we don’t include the covariate?</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">result.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">am</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">summary.lm</span><span class="p">(</span><span class="n">result.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## aov(formula = mpg ~ am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3923 -3.0923 -0.2974  3.2439  9.5077 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   17.147      1.125  15.247 1.13e-15 ***
## am1            7.245      1.764   4.106 0.000285 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.902 on 30 degrees of freedom
## Multiple R-squared:  0.3598,	Adjusted R-squared:  0.3385 
## F-statistic: 16.86 on 1 and 30 DF,  p-value: 0.000285
</code></pre>
</div>

<ul>
  <li>Adjusted R-squared has gone down from 0.77 to 0.34</li>
  <li>Auto/Manual is explaining ‘more’ of the variance when we remove the effect of the covariate</li>
</ul>

<hr />

<h3 id="interaction-term">Interaction term</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">result.3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">hp</span><span class="o">*</span><span class="n">am</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">result.3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">am</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="o">:</span><span class="n">am</span><span class="w"> </span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">summary.lm</span><span class="p">(</span><span class="n">result.3</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## aov(formula = mpg ~ hp + am + hp:am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3818 -2.2696  0.1344  1.7058  5.8752 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 26.6248479  2.1829432  12.197 1.01e-12 ***
## hp          -0.0591370  0.0129449  -4.568 9.02e-05 ***
## am1          5.2176534  2.6650931   1.958   0.0603 .  
## hp:am1       0.0004029  0.0164602   0.024   0.9806    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.961 on 28 degrees of freedom
## Multiple R-squared:  0.782,	Adjusted R-squared:  0.7587 
## F-statistic: 33.49 on 3 and 28 DF,  p-value: 2.112e-09
</code></pre>
</div>

<ul>
  <li>confirms that the interaction between <strong>am</strong> and <strong>hp</strong> is non-significant (assumption 2)</li>
</ul>

<hr />

<h2 id="references">References</h2>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

<p><a href="https://www.tutorialspoint.com/r/r_analysis_of_covariance.htm">R - Analysis of Covariance (Tutorials Point)</a></p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2016/11/21/tutorial-10-non-parametric.html">
            Tutorial 10 - Non-parametric tests and categorical data
            <small>21 Nov 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2016/11/15/tutorial-9-repeated.html">
            Tutorial 9 - Repeated-Measures and Mixed Design
            <small>15 Nov 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2016/11/01/tutorial-7-logistic-regression.html">
            Tutorial 7 - Logistic Regression
            <small>01 Nov 2016</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>







<div id="disqus_thread"></div>

<script>(function() {
        var d = document, s = d.createElement('script');
        s.src = '//MIE1402.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


    </div>

  </body>
</html>

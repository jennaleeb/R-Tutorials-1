<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      R &middot; 
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/poole.css">
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/syntax.css">
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/hyde.css">
  <link rel="stylesheet" href="/R-Tutorials-1/public/css/custom.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/R-Tutorials-1public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/R-Tutorials-1public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <!-- Mathjax -->
  <script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    
    <!--Disqus comment counts-->
    <script id="dsq-count-scr" src="//MIE1402.disqus.com/count.js" async></script>
    
</head>


  <body class="theme-base-0b">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/R-Tutorials-1">
          R
        </a>
      </h1>
      <p class="lead">Content for MIE 1402 tutorials</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/R-Tutorials-1">Home</a>

      

      
      
        
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/R-Tutorials-1/about.html">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/R-Tutorials-1/archive.html">Archives</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/R-Tutorials-1/categories.html">Categories</a>
          
        
      
        
          
        
      
      <a class="sidebar-nav-item" href="https://github.com/jennaleeb/R-Tutorials-1">GitHub project</a>
    </nav>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/11/15/tutorial-9-repeated.html">
        Tutorial 9 - Repeated-Measures and Mixed Design
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/11/15/tutorial-9-repeated.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">15 Nov 2016</span>

    <h2 id="repeated-measures-and-mixed-design">Repeated-Measures and Mixed Design</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 9<br />
   MIE 1402</p>

<hr />

<h2 id="introduction">Introduction</h2>

<ul>
  <li>‘Repeated-measures’ - when the same entities participate in all conditions of an experiment or provide data at multiple time points</li>
  <li>Previously, we have looked at differences between several means when different entities contribute to different means</li>
  <li>BUT - the assumption of independence is now violated
    <ul>
      <li>data taken under different experimental conditions (but same entity) are likely to be related</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="sphericity">Sphericity</h2>

<ul>
  <li>Instead, we assume that the relationship between pairs of experimental conditions is similar (sphericity)
    <ul>
      <li>equality of variances of the <em>differences</em> between treatment levels</li>
      <li>you need at least 3 conditions for sphericity to be an issue (i.e. you need to test for it)</li>
    </ul>
  </li>
</ul>

<p style="text-align: center;">$$var_{A-B} \approx var_{A-C} \approx var_{B-C}$$
</p>

<ul>
  <li>Can also be assessed with Mauchly’s test (null hypothesis: variances between conditions are equal)</li>
</ul>

<hr />

<h2 id="dealing-with-violations-of-sphericity">Dealing with violations of sphericity</h2>
<p>(to produce a valid <script type="math/tex">F</script>-ratio)</p>

<ol>
  <li>Apply a correction factor to the degrees of freedom in the <script type="math/tex">F</script>-ratio:
    <ul>
      <li>Greenhouse-Geisser correction <script type="math/tex">\hat\varepsilon</script> (varies between 1 &amp; <script type="math/tex">\frac{1}{k-1}</script>)</li>
      <li>Hynh-Feld correction <script type="math/tex">\tilde\varepsilon</script> (less conservative)</li>
    </ul>
  </li>
  <li>Use multivariate analysis of variance (MANOVA)
    <ul>
      <li>don’t need assumption of sphericity</li>
    </ul>
  </li>
  <li>Analyse data as a multilevel model
    <ul>
      <li>regression where we can include multiple observations form the same entities</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="theoretical-framework">Theoretical framework</h2>

<ul>
  <li>In independent ANOVA, within-participant variance is our <script type="math/tex">SS_{R}</script></li>
  <li>In repeated measures, some of the within-participant variation comes from the effects of our experimental manipulation</li>
  <li>as w/ independent design, the <script type="math/tex">F</script>-ratio is the variation due to experimental manipulation (<script type="math/tex">SS_{M}</script>) vs. variation due to random factors (<script type="math/tex">SS_{R}</script>)</li>
</ul>

<p><img src="/R-Tutorials-1/figure/source/2016-11-15-tutorial-9-repeated/partitioning_variance.jpg" alt="" />
<em>Field</em>, p. 556</p>

<hr />

<h2 id="repeated-measures-in-r">Repeated-measures in R</h2>

<p>Grab data: <a href="http://bit.ly/2fT3QXW">http://bit.ly/2fT3QXW</a></p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Essay</th>
      <th style="text-align: right">tutor1</th>
      <th style="text-align: right">tutor2</th>
      <th style="text-align: right">tutor3</th>
      <th style="text-align: right">tutor4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: right">62</td>
      <td style="text-align: right">58</td>
      <td style="text-align: right">63</td>
      <td style="text-align: right">64</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: right">63</td>
      <td style="text-align: right">60</td>
      <td style="text-align: right">68</td>
      <td style="text-align: right">65</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: right">65</td>
      <td style="text-align: right">61</td>
      <td style="text-align: right">72</td>
      <td style="text-align: right">65</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: right">68</td>
      <td style="text-align: right">64</td>
      <td style="text-align: right">58</td>
      <td style="text-align: right">61</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: right">69</td>
      <td style="text-align: right">65</td>
      <td style="text-align: right">54</td>
      <td style="text-align: right">59</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td style="text-align: right">71</td>
      <td style="text-align: right">67</td>
      <td style="text-align: right">65</td>
      <td style="text-align: right">50</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="step-1-format-data">Step 1: Format data</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">dataLong</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">melt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Essay"</span><span class="p">)</span><span class="w">
</span><span class="n">kable</span><span class="p">(</span><span class="n">dataLong</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Essay</th>
      <th style="text-align: left">variable</th>
      <th style="text-align: right">value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">62</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">63</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">65</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">68</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">69</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">71</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">78</td>
    </tr>
    <tr>
      <td style="text-align: right">8</td>
      <td style="text-align: left">tutor1</td>
      <td style="text-align: right">75</td>
    </tr>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">58</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">60</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">61</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">64</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">65</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">67</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">66</td>
    </tr>
    <tr>
      <td style="text-align: right">8</td>
      <td style="text-align: left">tutor2</td>
      <td style="text-align: right">73</td>
    </tr>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">63</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">68</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">72</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">58</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">54</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">65</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">67</td>
    </tr>
    <tr>
      <td style="text-align: right">8</td>
      <td style="text-align: left">tutor3</td>
      <td style="text-align: right">75</td>
    </tr>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">64</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">65</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">65</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">61</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">59</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">50</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">50</td>
    </tr>
    <tr>
      <td style="text-align: right">8</td>
      <td style="text-align: left">tutor4</td>
      <td style="text-align: right">45</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="step-1-format-data-1">Step 1: Format data</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="nf">names</span><span class="p">(</span><span class="n">dataLong</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Essay"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Tutor"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Grade"</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">dataLong</span><span class="o">$</span><span class="n">Tutor</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##  Factor w/ 4 levels "tutor1","tutor2",..: 1 1 1 1 1 1 1 1 2 2 ...
</code></pre>
</div>

<hr />

<h3 id="step-2-exploring-the-data">Step 2: Exploring the data</h3>

<ul>
  <li>parametric assumptions, graph the data, etc.</li>
  <li>contrasts?</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">contrasts</span><span class="p">(</span><span class="n">dataLong</span><span class="o">$</span><span class="n">Tutor</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##        tutor2 tutor3 tutor4
## tutor1      0      0      0
## tutor2      1      0      0
## tutor3      0      1      0
## tutor4      0      0      1
</code></pre>
</div>

<ul>
  <li>must be orthogonal if you want Type III sums of squares, see <em>Field</em>, 568, but we only have 1 variable</li>
</ul>

<hr />

<h3 id="step-3-compute-anova">Step 3: Compute ANOVA</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ez</span><span class="p">)</span><span class="w">
</span><span class="n">model.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ezANOVA</span><span class="p">(</span><span class="n">dataLong</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">Grade</span><span class="p">),</span><span class="w"> </span><span class="n">wid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">Essay</span><span class="p">),</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">Tutor</span><span class="p">),</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<hr />

<h3 id="step-4-examine-anova">Step 4: Examine ANOVA</h3>

<ul>
  <li>4.1 - check sphericity assumption</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>## $ANOVA
##        Effect DFn DFd        SSn      SSd           F            p p&lt;.05
## 1 (Intercept)   1   7 130816.125  103.375 8858.165659 4.027213e-12     *
## 2       Tutor   3  21    554.125 1048.375    3.699893 2.784621e-02     *
##         ges
## 1 0.9912725
## 2 0.3248333
## 
## $`Mauchly's Test for Sphericity`
##   Effect         W          p p&lt;.05
## 2  Tutor 0.1310624 0.04305676     *
## 
## $`Sphericity Corrections`
##   Effect       GGe      p[GG] p[GG]&lt;.05       HFe      p[HF] p[HF]&lt;.05
## 2  Tutor 0.5576185 0.06287878           0.7122543 0.04712856         *
</code></pre>
</div>

<hr />

<h3 id="step-5-individual-contrastspost-hoc">Step 5: Individual contrasts/post-hoc</h3>

<ul>
  <li>didn’t really have a hypothesis so no informative contrasts</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">pairwise.t.test</span><span class="p">(</span><span class="n">dataLong</span><span class="o">$</span><span class="n">Grade</span><span class="p">,</span><span class="w"> </span><span class="n">dataLong</span><span class="o">$</span><span class="n">Tutor</span><span class="p">,</span><span class="w"> </span><span class="n">paired</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">p.adjust.method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bonferroni"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## 	Pairwise comparisons using paired t tests 
## 
## data:  dataLong$Grade and dataLong$Tutor 
## 
##        tutor1 tutor2 tutor3
## tutor2 0.022  -      -     
## tutor3 1.000  1.000  -     
## tutor4 0.261  0.961  0.637 
## 
## P value adjustment method: bonferroni
</code></pre>
</div>

<hr />

<h2 id="factorial-repeated-measures-design">Factorial repeated-measures design</h2>

<ul>
  <li>Nothing terribly new</li>
  <li>More than one independent variable, add it to ` within = .(var1, var2)`</li>
  <li>Now we look at main effects + interaction effects</li>
  <li>Again check sphericity</li>
  <li>Break down main effects using contrasts/post-hoc tests</li>
</ul>

<hr />

<h2 id="mixed-designs">Mixed Designs</h2>

<ul>
  <li>Includes both between groups &amp; repeated measures</li>
  <li><em>Field</em>, Ch. 14 example: what do people look for in a partner?</li>
  <li>Independent variables:
    <ul>
      <li>Personality</li>
      <li>Looks</li>
      <li>Gender</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="mixed-design-using-ezanova">Mixed Design using <code class="highlighter-rouge">ezANOVA()</code></h2>

<p>(not going through all data set-up)</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">model.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ezANOVA</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datingLong</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">rating</span><span class="p">),</span><span class="w"> </span><span class="n">wid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">participant</span><span class="p">),</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">gender</span><span class="p">),</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">(</span><span class="n">looks</span><span class="p">,</span><span class="w"> </span><span class="n">personality</span><span class="p">),</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<hr />

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">model.2</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $ANOVA
##                     Effect DFn DFd        SSn       SSd            F
## 1              (Intercept)   1  18 846249.800  760.2222 2.003690e+04
## 2                   gender   1  18      0.200  760.2222 4.735457e-03
## 3                    looks   2  36  20779.633  882.7111 4.237325e+02
## 5              personality   2  36  23233.600 1274.0444 3.282498e+02
## 4             gender:looks   2  36   3944.100  882.7111 8.042699e+01
## 6       gender:personality   2  36   4420.133 1274.0444 6.244868e+01
## 7        looks:personality   4  72   4055.267 1992.6222 3.663253e+01
## 8 gender:looks:personality   4  72   2669.667 1992.6222 2.411596e+01
##              p p&lt;.05          ges
## 1 7.013239e-29     * 9.942319e-01
## 2 9.458958e-01       4.073486e-05
## 3 9.594812e-26     * 8.088849e-01
## 5 7.689430e-24     * 8.255493e-01
## 4 5.234187e-14     * 4.454748e-01
## 6 1.974986e-12     * 4.737685e-01
## 7 1.101308e-16     * 4.523510e-01
## 8 1.107801e-12     * 3.522328e-01
## 
## $`Mauchly's Test for Sphericity`
##                     Effect         W         p p&lt;.05
## 3                    looks 0.9602054 0.7081010      
## 4             gender:looks 0.9602054 0.7081010      
## 5              personality 0.9293298 0.5363446      
## 6       gender:personality 0.9293298 0.5363446      
## 7        looks:personality 0.6133545 0.5339382      
## 8 gender:looks:personality 0.6133545 0.5339382      
## 
## $`Sphericity Corrections`
##                     Effect       GGe        p[GG] p[GG]&lt;.05       HFe
## 3                    looks 0.9617284 7.624114e-25         * 1.0744125
## 4             gender:looks 0.9617284 1.487026e-13         * 1.0744125
## 5              personality 0.9339944 2.056621e-22         * 1.0380537
## 6       gender:personality 0.9339944 9.442426e-12         * 1.0380537
## 7        looks:personality 0.7993543 9.003598e-14         * 0.9922411
## 8 gender:looks:personality 0.7993543 1.470422e-10         * 0.9922411
##          p[HF] p[HF]&lt;.05
## 3 9.594812e-26         *
## 4 5.234187e-14         *
## 5 7.689430e-24         *
## 6 1.974986e-12         *
## 7 1.426883e-16         *
## 8 1.337876e-12         *
</code></pre>
</div>

<hr />

<h2 id="references">References</h2>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/11/07/tutorial-8-ancova.html">
        Tutorial 8 - ANCOVA
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/11/07/tutorial-8-ancova.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">07 Nov 2016</span>

    <h2 id="analysis-of-covariance-ancova">Analysis of Covariance (ANCOVA)</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 8<br />
   MIE 1402</p>

<hr />

<h2 id="introduction">Introduction</h2>

<ul>
  <li>We can extend the regression equation for ANOVA to include continuous variable(s) that predict the outcome variable</li>
  <li>
    <p>These <em>continuous</em> variables that are NOT part of the experimental manipulation (but can influence the outcome) is called a covariate</p>
  </li>
  <li>Dealing with covariates relatively simple:
    <ul>
      <li>Enter the variable into regression model first (hierarchical)</li>
      <li>Then, enter the dummy variables representing the experimental manipulation</li>
    </ul>
  </li>
  <li>Voila! Now we can see the effect of the experiment after the covariate(s) have been accounted for</li>
</ul>

<hr />

<h2 id="reasons-for-including-covariates">Reasons for including covariates</h2>

<p><strong>1. Reduce within-group error variance</strong></p>

<ul>
  <li>Explain some of the ‘unexplained’ variance (<script type="math/tex">SS_{R}</script>)</li>
</ul>

<p><strong>2. Elimination of confounds</strong></p>

<ul>
  <li>Remove bias of any variable that is known to influence the dependent variable</li>
</ul>

<hr />

<h2 id="assumptions-of-ancova">Assumptions of ANCOVA</h2>

<p>Same as ANOVA, plus:</p>

<p><strong>1. Independence of covariate and treatment effect</strong></p>

<ul>
  <li>if the covariate is to explain some of the <script type="math/tex">SS_{R}</script>, it must be independent of the experimental effect</li>
  <li>variance explained by treatment &amp; covariate should not overlap
    <ul>
      <li>covariate will (statiscally speaking) reduce the experimental effect!</li>
    </ul>
  </li>
  <li>problem can be avoided by randomizing participants, or matching experimental groups on the covariate</li>
  <li>to evaluate, run a t-test (or anova if &gt; 2) to see if the groups differ significantly on levels of the covariate</li>
</ul>

<hr />

<h2 id="example-mtcars">Example: mtcars</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">kable</span><span class="p">(</span><span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s2">"am"</span><span class="p">,</span><span class="s2">"mpg"</span><span class="p">,</span><span class="s2">"hp"</span><span class="p">)]))</span><span class="w">
</span></code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: right">am</th>
      <th style="text-align: right">mpg</th>
      <th style="text-align: right">hp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Mazda RX4</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">21.0</td>
      <td style="text-align: right">110</td>
    </tr>
    <tr>
      <td style="text-align: left">Mazda RX4 Wag</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">21.0</td>
      <td style="text-align: right">110</td>
    </tr>
    <tr>
      <td style="text-align: left">Datsun 710</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">22.8</td>
      <td style="text-align: right">93</td>
    </tr>
    <tr>
      <td style="text-align: left">Hornet 4 Drive</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">21.4</td>
      <td style="text-align: right">110</td>
    </tr>
    <tr>
      <td style="text-align: left">Hornet Sportabout</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">18.7</td>
      <td style="text-align: right">175</td>
    </tr>
    <tr>
      <td style="text-align: left">Valiant</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">18.1</td>
      <td style="text-align: right">105</td>
    </tr>
  </tbody>
</table>

<p><em>Note</em><br />
<strong>am:</strong> type of transmission (auto or manual)<br />
<strong>mpg:</strong> miles per gallon<br />
<strong>hp:</strong> horsepower</p>

<hr />

<p><img src="/R-Tutorials-1/figure/source/2016-11-09-tutorial-8-ancova/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4" /></p>

<p><script type="math/tex">r_{hp,mpg}</script> = -0.7761684</p>

<hr />

<h2 id="assumption-1">Assumption 1</h2>

<p>Run a t-test to see if groups differ significantly on covariate</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="p">)</span><span class="w">
</span><span class="n">t.test</span><span class="p">(</span><span class="n">mtcars</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">,]</span><span class="o">$</span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,]</span><span class="o">$</span><span class="n">hp</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## 	Welch Two Sample t-test
## 
## data:  mtcars[mtcars$am == 0, ]$hp and mtcars[mtcars$am == 1, ]$hp
## t = 1.2662, df = 18.715, p-value = 0.221
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -21.87858  88.71259
## sample estimates:
## mean of x mean of y 
##  160.2632  126.8462
</code></pre>
</div>

<hr />

<h2 id="assumptions-of-ancova-1">Assumptions of ANCOVA</h2>

<p><strong>2. Homogeneity of Regression Slopes</strong></p>

<ul>
  <li>the slope of the regression line should be approximately the same in all groups</li>
  <li>i.e. relationship between covariate and outcome variable should not differ significantly between groups</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">leveneTest</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Levene's Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  1  0.1842 0.6709
##       30
</code></pre>
</div>

<hr />

<h2 id="running-the-ancova-analysis">Running the ANCOVA Analysis</h2>

<ul>
  <li>Recall: we want to study the effect of <strong>am</strong> on <strong>mpg</strong>, taking into account the covariate <strong>hp</strong></li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">result.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">hp</span><span class="o">+</span><span class="n">am</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">summary.lm</span><span class="p">(</span><span class="n">result.1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## aov(formula = mpg ~ hp + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3843 -2.2642  0.1366  1.6968  5.8657 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 26.584914   1.425094  18.655  &lt; 2e-16 ***
## hp          -0.058888   0.007857  -7.495 2.92e-08 ***
## am1          5.277085   1.079541   4.888 3.46e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.909 on 29 degrees of freedom
## Multiple R-squared:  0.782,	Adjusted R-squared:  0.767 
## F-statistic: 52.02 on 2 and 29 DF,  p-value: 2.55e-10
</code></pre>
</div>

<hr />

<h3 id="what-does-it-look-like-if-we-dont-include-the-covariate">What does it look like if we don’t include the covariate?</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">result.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">am</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">summary.lm</span><span class="p">(</span><span class="n">result.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## aov(formula = mpg ~ am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3923 -3.0923 -0.2974  3.2439  9.5077 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   17.147      1.125  15.247 1.13e-15 ***
## am1            7.245      1.764   4.106 0.000285 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.902 on 30 degrees of freedom
## Multiple R-squared:  0.3598,	Adjusted R-squared:  0.3385 
## F-statistic: 16.86 on 1 and 30 DF,  p-value: 0.000285
</code></pre>
</div>

<ul>
  <li>Adjusted R-squared has gone down from 0.77 to 0.34</li>
  <li>Auto/Manual is explaining ‘more’ of the variance when we remove the effect of the covariate</li>
</ul>

<hr />

<h3 id="interaction-term">Interaction term</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">result.3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">hp</span><span class="o">*</span><span class="n">am</span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">result.3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">mpg</span><span class="o">~</span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">am</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="o">:</span><span class="n">am</span><span class="w"> </span><span class="p">,</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">summary.lm</span><span class="p">(</span><span class="n">result.3</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## aov(formula = mpg ~ hp + am + hp:am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3818 -2.2696  0.1344  1.7058  5.8752 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 26.6248479  2.1829432  12.197 1.01e-12 ***
## hp          -0.0591370  0.0129449  -4.568 9.02e-05 ***
## am1          5.2176534  2.6650931   1.958   0.0603 .  
## hp:am1       0.0004029  0.0164602   0.024   0.9806    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.961 on 28 degrees of freedom
## Multiple R-squared:  0.782,	Adjusted R-squared:  0.7587 
## F-statistic: 33.49 on 3 and 28 DF,  p-value: 2.112e-09
</code></pre>
</div>

<ul>
  <li>confirms that the interaction between <strong>am</strong> and <strong>hp</strong> is non-significant (assumption 2)</li>
</ul>

<hr />

<h2 id="references">References</h2>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

<p><a href="https://www.tutorialspoint.com/r/r_analysis_of_covariance.htm">R - Analysis of Covariance (Tutorials Point)</a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/11/01/tutorial-7-logistic-regression.html">
        Tutorial 7 - Logistic Regression
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/11/01/tutorial-7-logistic-regression.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">01 Nov 2016</span>

    <h2 id="logistic-regression">Logistic Regression</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 7<br />
   MIE 1402</p>

<hr />

<h2 id="introduction">Introduction</h2>

<ul>
  <li>Logistic regression is simply regression with an outcome variable that is <strong>categorical</strong></li>
  <li>The predictor variables are continuous or categorical
    <ul>
      <li>if the predictor variables are categorical only, would use a chi-squared test (<em>Field</em>, Ch. 18)</li>
    </ul>
  </li>
  <li>For example, in medical research:
    <ul>
      <li>given a set of cancer patients, what is the likelihood that their tumors are cancerous vs. benign?</li>
      <li>use existing database to establish which variables are influential in predicting malignancy</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="logistic-regression-equation">Logistic regression equation</h2>

<ul>
  <li>We are instead predicting the <strong>probability</strong> of <script type="math/tex">Y</script> occuring, rather than the <strong>value</strong> of <script type="math/tex">Y</script></li>
</ul>

<script type="math/tex; mode=display">P(Y) = \frac{1}{1+e^{-(b_{0}+b_{1}X_{1}+b_{2}X_{2}...)}}</script>

<ul>
  <li>
    <p>Since we cannot apply linear regression when the outcome variable is categorical (would violate the assumption of linearity)</p>
  </li>
  <li>We instead take the logarithm of the equation</li>
  <li>This allows us to express a non-linear relationship in a linear way
    <ul>
      <li><script type="math/tex">P(Y)</script> is continuous, and varies from 0 to 1</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="assessing-the-model">Assessing the model</h2>

<ul>
  <li>for a given occurance, <script type="math/tex">Y</script> will either be 0 (didn’t occur) or 1 (did occur)</li>
  <li>so <script type="math/tex">P(Y)</script> is the <em>chance</em> that it occured</li>
  <li>To assess whether our model fits the data, we can compare the <strong>observed</strong> and <strong>predicted</strong> values of the outcome</li>
  <li>The measure is called the <strong>log-likelihood</strong>
    <ul>
      <li>Analogous to <script type="math/tex">SS_{R}</script> in that it is an indicator of how much unexplained information there is after a model has been fitted</li>
      <li>Large value = lots of unexplained observations</li>
    </ul>
  </li>
</ul>

<script type="math/tex; mode=display">\text{log-likelihood} = \sum_{i=1}^{N}[Y_{i}ln(P(Y_{i}))+(1-Y_{i})ln(1-P(Y_{i})))]</script>

<hr />

<h2 id="assessing-the-model-1">Assessing the model</h2>

<script type="math/tex; mode=display">\text{log-likelihood} = \sum_{i=1}^{N}[Y_{i}ln(P(Y_{i}))+(1-Y_{i})ln(1-P(Y_{i})))]</script>

<ul>
  <li>recall the <script type="math/tex">ln</script> distribution:</li>
</ul>

<p><img src="/R-Tutorials-1/figure/source/2016-11-01-tutorial-7-logistic-regression/unnamed-chunk-2-1.png" alt="plot of chunk unnamed-chunk-2" /></p>

<ul>
  <li>What happens when<br />
<script type="math/tex">Y_{i} = 0</script>?<br />
<script type="math/tex">Y_{i} = 1</script>?</li>
</ul>

<hr />

<h2 id="deviance-statistic">Deviance statistic</h2>
<ul>
  <li>deviance = <script type="math/tex">-2 x LL</script></li>
  <li>more convenient because it has a chi-square distribution</li>
  <li>easier to calculate significance of value</li>
  <li>We use the deviance to compare models (similar to <strong>aov</strong>(model_1, model_2))
    <ul>
      <li>Does our model improve prediction?</li>
    </ul>

    <p><script type="math/tex">\chi^{2}=2LL(new) - 2LL(baseline)</script><br />
<script type="math/tex">df = k_{new} - k_{baseline}</script></p>
  </li>
  <li>In linear regression, the baseline model is the mean</li>
  <li>In logistic, it is the category with the highest <strong>frequency</strong>
    <ul>
      <li>The category with the higher # of cases (0 or 1) is our “best guess”</li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="other-ways-to-assess-the-model">Other ways to assess the model</h3>
<p>(we won’t go over)
- <script type="math/tex">R</script>, <script type="math/tex">R^{2}</script>
  + Hosmer and Lemeshow’s <script type="math/tex">R^{2}_{L}</script>
  + Cox and Snell’s <script type="math/tex">R^{2}_{CS}</script>
  + Nagelkerke’s <script type="math/tex">R^{2}_{N}</script>
- Each have their own theoretical background and slightly different equations (<em>Field</em>, 317-18)
- AIC, BIC</p>

<hr />

<h2 id="odds-ratio">Odds ratio</h2>

<ul>
  <li>More important to interpreting logistic regression is the value of the odds ratio, <script type="math/tex">e^{B}</script>
    <ul>
      <li>Indicator of the change in odds resulting from a <strong>unit change</strong> in the predictor</li>
    </ul>
  </li>
  <li>The <strong>“odds”</strong> of an event occuring is:</li>
</ul>

<script type="math/tex; mode=display">\text{odds} = \frac{P(event)}{P(no\,event)}</script>

<p>Where:</p>

<script type="math/tex; mode=display">P(event\,Y) = \frac{1}{1+e^{-b_{0}+b_{1}X_{1}+b_{2}X_{2}...}}</script>

<script type="math/tex; mode=display">P(no\,event\,Y) = 1 - P(event\,Y)</script>

<hr />

<h2 id="odds-ratio-1">Odds ratio</h2>

<p>So, the odds <strong>ratio</strong> is</p>

<script type="math/tex; mode=display">\Delta odds = \frac{\text{odds after a unit change in predictor}}{\text{original odds}}</script>

<ul>
  <li>if &gt; 1, as the predictor increases, the odds of the outcome occuring increase</li>
</ul>

<hr />

<h2 id="logistic-regression-in-r">Logistic regression in R</h2>

<p>How does GRE, GPA and prestige of undergrad institution influence admission into graduate school? <a href="http://www.ats.ucla.edu/stat/r/dae/logit.htm">(UCLA Institute for Digital Research and Education)</a></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"http://www.ats.ucla.edu/stat/data/binary.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   admit gre  gpa rank
## 1     0 380 3.61    3
## 2     1 660 3.67    3
## 3     1 800 4.00    1
## 4     1 640 3.19    4
## 5     0 520 2.93    4
## 6     1 760 3.00    2
</code></pre>
</div>

<hr />

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">mlogit</span><span class="p">)</span><span class="w">

</span><span class="c1">### Let's start by just looking at GPA
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">model.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">admit</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">gpa</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"binomial"</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model.1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## glm(formula = admit ~ gpa, family = "binomial", data = data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.1131  -0.8874  -0.7566   1.3305   1.9824  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -4.3576     1.0353  -4.209 2.57e-05 ***
## gpa           1.0511     0.2989   3.517 0.000437 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 499.98  on 399  degrees of freedom
## Residual deviance: 486.97  on 398  degrees of freedom
## AIC: 490.97
## 
## Number of Fisher Scoring iterations: 4
</code></pre>
</div>

<ul>
  <li>The residual deviance is lower than the null deviance (model is now predicting the outcome more accurately than baseline)</li>
  <li>Question of how <em>much</em> better the model predicts the outcome is assessed using the <script type="math/tex">\chi^{2}</script> statistic:
<script type="math/tex">\chi^{2} = 499.98 - 486.97 = 13.01</script></li>
</ul>

<hr />

<p>Or in R:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">model.1.Chi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model.1</span><span class="o">$</span><span class="n">null.deviance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">model.1</span><span class="o">$</span><span class="n">deviance</span><span class="w">
</span><span class="nf">round</span><span class="p">(</span><span class="n">model.1.Chi</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 13.01
</code></pre>
</div>

<p>Find the probability associated with this chi-square statistic by using the pchisq() function, and the difference in degrees of freedom</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model.1</span><span class="o">$</span><span class="n">df.null</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">model.1</span><span class="o">$</span><span class="n">df.residual</span><span class="w">
</span><span class="n">df</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pchisq</span><span class="p">(</span><span class="n">model.1.Chi</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="c1"># this is the probability we want
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 0.0003100148
</code></pre>
</div>

<p>So we can report:<br />
<script type="math/tex">% <![CDATA[
\chi^{2}(1) = 13.01, p < .001 %]]></script></p>

<hr />

<h3 id="assessing-coefficients">Assessing coefficients</h3>

<ul>
  <li>similar to linear regression, the <script type="math/tex">b</script> estimate replaces the value in our original equation</li>
  <li>represents the change in the logit of the outcome variable associated with a one-unit change in the predictor variable
    <ul>
      <li>the natural logarithm (<script type="math/tex">ln</script>) if the odds of <script type="math/tex">Y</script> occuring</li>
    </ul>
  </li>
  <li><script type="math/tex">z</script>-statistic tells us whether the <script type="math/tex">b</script> coefficient is significantly different from 0</li>
</ul>

<hr />

<h3 id="odds-ratio-2">Odds ratio</h3>

<script type="math/tex; mode=display">\frac{\text{odds after a unit change in the predictor}}{\text{original odds}}</script>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="nf">exp</span><span class="p">(</span><span class="n">model.1</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## (Intercept)         gpa 
##  0.01280926  2.86082123
</code></pre>
</div>

<hr />

<h2 id="more-than-one-predictor">More than one predictor</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 'data.frame':	400 obs. of  4 variables:
##  $ admit: int  0 1 1 1 0 1 1 0 1 0 ...
##  $ gre  : int  380 660 800 640 520 760 560 400 540 700 ...
##  $ gpa  : num  3.61 3.67 4 3.19 2.93 3 2.98 3.08 3.39 3.92 ...
##  $ rank : int  3 3 1 4 4 2 1 2 3 2 ...
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">data</span><span class="o">$</span><span class="n">rank</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">rank</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<hr />

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">model.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">admit</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gre</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"binomial"</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## glm(formula = admit ~ gpa + gre + rank, family = "binomial", 
##     data = data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6268  -0.8662  -0.6388   1.1490   2.0790  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -3.989979   1.139951  -3.500 0.000465 ***
## gpa          0.804038   0.331819   2.423 0.015388 *  
## gre          0.002264   0.001094   2.070 0.038465 *  
## rank2       -0.675443   0.316490  -2.134 0.032829 *  
## rank3       -1.340204   0.345306  -3.881 0.000104 ***
## rank4       -1.551464   0.417832  -3.713 0.000205 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 499.98  on 399  degrees of freedom
## Residual deviance: 458.52  on 394  degrees of freedom
## AIC: 470.52
## 
## Number of Fisher Scoring iterations: 4
</code></pre>
</div>

<hr />

<h3 id="interpretation">Interpretation</h3>

<ul>
  <li>for every unit change in <strong>gre</strong> and <strong>gpa</strong>, we get the value that the log odds value increases by</li>
  <li>But for interpreting <strong>rank</strong> recall:</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">contrasts</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">rank</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   2 3 4
## 1 0 0 0
## 2 1 0 0
## 3 0 1 0
## 4 0 0 1
</code></pre>
</div>
<ul>
  <li>For <strong>rank</strong>, we are getting the change in log odds that occurs when you compare institution with rank 2 versus rank 1</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="nf">exp</span><span class="p">(</span><span class="n">model.2</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## (Intercept)         gpa         gre       rank2       rank3       rank4 
##   0.0185001   2.2345448   1.0022670   0.5089310   0.2617923   0.2119375
</code></pre>
</div>
<ul>
  <li>Now we can say that for a one unit increase in gpa, the odds of being admitted to graduate school (versus not being admitted) increase by a factor of 2.23</li>
</ul>

<hr />

<h2 id="comparing-models">Comparing models</h2>

<ul>
  <li>You can use the difference in deviance equation</li>
  <li>Or in R, simply:</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">anova</span><span class="p">(</span><span class="n">model.1</span><span class="p">,</span><span class="w"> </span><span class="n">model.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Analysis of Deviance Table
## 
## Model 1: admit ~ gpa
## Model 2: admit ~ gpa + gre + rank
##   Resid. Df Resid. Dev Df Deviance
## 1       398     486.97            
## 2       394     458.52  4    28.45
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pchisq</span><span class="p">(</span><span class="m">28.45</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1.010924e-05
</code></pre>
</div>

<hr />

<h2 id="references">References</h2>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

<p>R Data Analysis Examples: Logit Regression. UCLA Institute for Digital Research and Education. http://www.ats.ucla.edu/stat/r/dae/logit.htm</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/10/25/tutorial-6-anova.html">
        Tutorial 6 - Comparing several means (ANOVA)
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/10/25/tutorial-6-anova.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">25 Oct 2016</span>

    <h2 id="comparing-several-means-anova">Comparing Several Means: ANOVA</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 6<br />
   MIE 1402</p>

<hr />

<h2 id="anova-as-an-omnibus-test">ANOVA as an omnibus test</h2>
<ul>
  <li>
    <p>Allows us to compare the means of three or more groups without inflating the error (see <em>Field</em>, pg 399)</p>

    <p><strong>Eg inflating the error:</strong>
+ Suppose we consider the safety of a drug in terms of the occurrences of different types of side effects. As more types of side effects are considered, it becomes more likely that the new drug will appear to be less safe than existing drugs in terms of at least one side effect <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">Wikipedia</a></p>
  </li>
  <li>Produces an <script type="math/tex">F</script>-statistic, which compares the systematic variance to the unsystematic variance</li>
  <li>“is the <script type="math/tex">explained\, variance</script> <script type="math/tex">></script> <script type="math/tex">unexplained\, variance</script>, overall?”</li>
</ul>

<hr />

<h2 id="anova-as-regression">ANOVA as Regression</h2>
<ul>
  <li>Both just configurations of the General Linear Model (GLM)</li>
  <li>How well does our model (individual groupings) predict the data, compared to the error?
    <ul>
      <li>This is the same as: are our groups significantly different?</li>
      <li>Regression with a categorial predictor variable</li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="data-we-are-using">Data we are using:</h3>
<ul>
  <li><a href="https://studysites.sagepub.com/dsur/study/articles.htm">https://studysites.sagepub.com/dsur/study/articles.htm</a></li>
</ul>

<style type="text/css">
.deck-container td { padding: 5px 20px}
</style>

<table>
  <thead>
    <tr>
      <th style="text-align: right">person</th>
      <th style="text-align: left">dose</th>
      <th style="text-align: right">libido</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Placebo</td>
      <td style="text-align: right">3</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: left">Placebo</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: left">Placebo</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: left">Placebo</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">5</td>
      <td style="text-align: left">Placebo</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: right">6</td>
      <td style="text-align: left">Low Dose</td>
      <td style="text-align: right">5</td>
    </tr>
    <tr>
      <td style="text-align: right">7</td>
      <td style="text-align: left">Low Dose</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">8</td>
      <td style="text-align: left">Low Dose</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: right">9</td>
      <td style="text-align: left">Low Dose</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">10</td>
      <td style="text-align: left">Low Dose</td>
      <td style="text-align: right">3</td>
    </tr>
    <tr>
      <td style="text-align: right">11</td>
      <td style="text-align: left">High Dose</td>
      <td style="text-align: right">7</td>
    </tr>
    <tr>
      <td style="text-align: right">12</td>
      <td style="text-align: left">High Dose</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: right">13</td>
      <td style="text-align: left">High Dose</td>
      <td style="text-align: right">5</td>
    </tr>
    <tr>
      <td style="text-align: right">14</td>
      <td style="text-align: left">High Dose</td>
      <td style="text-align: right">3</td>
    </tr>
    <tr>
      <td style="text-align: right">15</td>
      <td style="text-align: left">High Dose</td>
      <td style="text-align: right">6</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="anova-as-regression-1">ANOVA as Regression</h2>

<ul>
  <li>Does dose (placebo, low or high) predict libido? (regression-speak)</li>
  <li>Can also say: is libido in these 3 groups significantly different? (ANOVA-speak)</li>
</ul>

<p><img src="/R-Tutorials-1/figure/source/2016-10-25-tutorial-6-anova/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4" /></p>

<hr />

<h2 id="anova-as-regression-2">ANOVA as Regression</h2>

<ul>
  <li>If our predictor variable (dose) has 3 ordered levels (placebo, low dose, high dose)</li>
</ul>

<p>We can set our regression equation to:</p>

<script type="math/tex; mode=display">libido_{i} = b_{0} + b_{2high_{i}} + b_{1low_{i}} + \epsilon_{i}</script>

<p>Where:</p>

<p><script type="math/tex">b_0 = \overline{X}_{placebo}</script><br />
<script type="math/tex">b_1 = \overline{X}_{low dose} - \overline{X}_{placebo}</script><br />
<script type="math/tex">b_2 = \overline{X}_{high dose} - \overline{X}_{placebo}</script></p>

<ul>
  <li>We are asking: Does using group means to predict libido scores perform better than using the overall mean?</li>
</ul>

<hr />

<h3 id="try-this-yourself">Try this yourself:</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">lm.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">libido</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dose</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<ul>
  <li>calculate the means of each dose group</li>
  <li>prove to yourself that regression = ANOVA = GLM</li>
</ul>

<hr />

<h2 id="anova-as-regression-3">ANOVA as Regression</h2>

<p>Moral of the story: ANOVA can always be represented by the multiple regression equation in which the # of predictor variables is one <strong>less</strong> than the # of categories of the independent variable.</p>

<p><img src="/R-Tutorials-1/figure/source/2016-10-25-tutorial-6-anova/unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7" /></p>

<hr />

<h2 id="anova-in-r">ANOVA in R</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">viagraModel</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">libido</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">dose</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">viagraModel</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## dose         2  20.13  10.067   5.119 0.0247 *
## Residuals   12  23.60   1.967                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre>
</div>

<ul>
  <li>First row: <script type="math/tex">SS_{M} = 20.13</script> (model)</li>
  <li>Second row <script type="math/tex">SS_{R} = 23.60</script> (error)</li>
  <li><script type="math/tex">F</script> value: ratio of <script type="math/tex">MS_{M}/MS_{R}</script></li>
</ul>

<hr />

<h2 id="planned-contrasts">Planned contrasts</h2>
<ul>
  <li><script type="math/tex">F</script>-ratio does not tell us where differences between groups lie</li>
  <li>
    <p>Two approaches:</p>
  </li>
  <li>
    <p><strong>Planned contrasts:</strong> break down variance accounted for by the model into component parts (specific hypothesis)</p>

    <ul>
      <li>Not going to go into the theory today, but I highly recommend <em>Field</em> 419-424. This is one of those times where looking through the math helps.</li>
    </ul>
  </li>
  <li><strong>Post hoc tests:</strong> compare every group but use a stricter acceptance criterion (no specific hypothesis)</li>
</ul>

<hr />

<h2 id="built-in-planned-contrasts-in-r">Built-in planned contrasts in R</h2>

<ul>
  <li>R actually sets default constrasts for your grouping variable</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">summary.lm</span><span class="p">(</span><span class="n">viagraModel</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## aov(formula = libido ~ dose, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##   -2.0   -1.2   -0.2    0.9    2.0 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)     2.2000     0.6272   3.508  0.00432 **
## doseLow Dose    1.0000     0.8869   1.127  0.28158   
## doseHigh Dose   2.8000     0.8869   3.157  0.00827 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.402 on 12 degrees of freedom
## Multiple R-squared:  0.4604,	Adjusted R-squared:  0.3704 
## F-statistic: 5.119 on 2 and 12 DF,  p-value: 0.02469
</code></pre>
</div>

<hr />

<ul>
  <li>Compares each group to the base (first) group
    <ul>
      <li>Is each dose signficantly different than the placebo?</li>
    </ul>
  </li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">contrasts</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">dose</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##           Low Dose High Dose
## Placebo          0         0
## Low Dose         1         0
## High Dose        0         1
</code></pre>
</div>

<ul>
  <li>If we wanted to set our own contrasts
    <ul>
      <li>e.g. is any viagra (low or high) significantly different than the placebo, and are high and low doses different from each other?</li>
    </ul>
  </li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">contrast_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># placebo vs viagra
</span><span class="n">contrast_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># high vs low
</span><span class="w">
</span><span class="n">contrasts</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">dose</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">contrast_1</span><span class="p">,</span><span class="w"> </span><span class="n">contrast_2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##           contrast_1 contrast_2
## Placebo           -2          0
## Low Dose           1         -1
## High Dose          1          1
</code></pre>
</div>

<hr />

<h2 id="more-complex-anovas">More complex ANOVAs</h2>

<h2 id="r-tutorials-1figuresource2016-10-25-tutorial-6-anovaanovanamingjpg"><img src="/R-Tutorials-1/figure/source/2016-10-25-tutorial-6-anova/anova_naming.jpg" alt="" /></h2>

<h2 id="more-complex-anovas-1">More complex ANOVAs</h2>

<ul>
  <li>Benefit of using ANOVA is you can look at the effect of more than one independent variable, and how they interact
    <ul>
      <li>Main effects</li>
      <li>Interaction effects</li>
    </ul>
  </li>
  <li>In R:</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">aov_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">outcome</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">predictor1</span><span class="o">*</span><span class="n">predictor2</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_frame</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<hr />

<h2 id="references">References</h2>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

<p><a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">https://en.wikipedia.org/wiki/Multiple_comparisons_problem</a></p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/10/11/tutorial-5-data-manipulation-reporting.html">
        Tutorial 5 - Data manipulation and reporting
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/10/11/tutorial-5-data-manipulation-reporting.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">11 Oct 2016</span>

    <h2 id="data-manipulation-and-reporting">Data Manipulation and Reporting</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 5<br />
   MIE 1402</p>

<hr />

<h2 id="creating-an-r-markdown-document-in-rstudio">Creating an R Markdown Document in RStudio</h2>

<ol>
  <li>File &gt; New File &gt; R Markdown</li>
  <li>YAML header contains document metadata
    <ul>
      <li>title</li>
      <li>author</li>
      <li>date</li>
      <li>output (html, pdf, word)</li>
    </ul>
  </li>
  <li>Knit to generate the document</li>
</ol>

<hr />

<h2 id="learning-the-syntax">Learning the syntax</h2>

<ul>
  <li>
    <p>For simple text, R Markdown follows markdown formatting syntax</p>

    <ul>
      <li><a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet">https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet</a></li>
    </ul>
  </li>
  <li>
    <p>For R, surround your text with</p>
  </li>
</ul>

<pre>```{r}
data(cars)
summary(cars)
```</pre>

<hr />

<h2 id="options-for-r-chunks">Options for R Chunks</h2>

<ul>
  <li><code class="highlighter-rouge">echo=FALSE</code> hides R code</li>
  <li><code class="highlighter-rouge">include=FALSE</code> prevent code and results from appearing</li>
  <li><code class="highlighter-rouge">eval=FALSE</code> dont run chunk</li>
  <li><code class="highlighter-rouge">message=FALSE</code> hides messages</li>
  <li><code class="highlighter-rouge">warnings=FALSE</code> hides warnings</li>
</ul>

<hr />

<h2 id="tables">Tables</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span><span class="w">
</span><span class="n">kable</span><span class="p">(</span><span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"html"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<table>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> mpg </th>
   <th style="text-align:right;"> cyl </th>
   <th style="text-align:right;"> disp </th>
   <th style="text-align:right;"> hp </th>
   <th style="text-align:right;"> drat </th>
   <th style="text-align:right;"> wt </th>
   <th style="text-align:right;"> qsec </th>
   <th style="text-align:right;"> vs </th>
   <th style="text-align:right;"> am </th>
   <th style="text-align:right;"> gear </th>
   <th style="text-align:right;"> carb </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Mazda RX4 </td>
   <td style="text-align:right;"> 21.0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 110 </td>
   <td style="text-align:right;"> 3.90 </td>
   <td style="text-align:right;"> 2.620 </td>
   <td style="text-align:right;"> 16.46 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mazda RX4 Wag </td>
   <td style="text-align:right;"> 21.0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 110 </td>
   <td style="text-align:right;"> 3.90 </td>
   <td style="text-align:right;"> 2.875 </td>
   <td style="text-align:right;"> 17.02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Datsun 710 </td>
   <td style="text-align:right;"> 22.8 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 108 </td>
   <td style="text-align:right;"> 93 </td>
   <td style="text-align:right;"> 3.85 </td>
   <td style="text-align:right;"> 2.320 </td>
   <td style="text-align:right;"> 18.61 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Hornet 4 Drive </td>
   <td style="text-align:right;"> 21.4 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 258 </td>
   <td style="text-align:right;"> 110 </td>
   <td style="text-align:right;"> 3.08 </td>
   <td style="text-align:right;"> 3.215 </td>
   <td style="text-align:right;"> 19.44 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Hornet Sportabout </td>
   <td style="text-align:right;"> 18.7 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 360 </td>
   <td style="text-align:right;"> 175 </td>
   <td style="text-align:right;"> 3.15 </td>
   <td style="text-align:right;"> 3.440 </td>
   <td style="text-align:right;"> 17.02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Valiant </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> 105 </td>
   <td style="text-align:right;"> 2.76 </td>
   <td style="text-align:right;"> 3.460 </td>
   <td style="text-align:right;"> 20.22 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
</tbody>
</table>

<p><br />
<em>looks better in document than in these slides</em></p>

<hr />

<h2 id="plots">Plots</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">disp</span><span class="p">,</span><span class="w"> </span><span class="n">drat</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<p><img src="/R-Tutorials-1/figure/source/2016-10-11-tutorial-5-data-manipulation-reporting/unnamed-chunk-2-1.png" alt="plot of chunk unnamed-chunk-2" /></p>

<hr />

<h2 id="data-manipulation-with-reshape2">Data manipulation with reshape2</h2>

<ul>
  <li><code class="highlighter-rouge">reshape2</code> makes it easy to transform data between wide and long formats</li>
  <li>Why/when would you need to use this?
    <ul>
      <li>running regressions, other statistical tests ( <code class="highlighter-rouge">lm()</code> requires long format)</li>
      <li>plotting data ( <code class="highlighter-rouge">ggplot</code> requires long format)</li>
      <li>Generally record data in wide format</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="wide-vs-long-data">‘Wide’ vs ‘Long’ data</h2>

<h3 id="wide-each-column-is-a-variable">Wide: each column is a variable</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 5    NA      NA 14.3   56     5   5
## 6    28      NA 14.9   66     5   6
</code></pre>
</div>

<hr />

<h3 id="long-column-for-various-variable-types-and-a-column-for-their-values">Long: column for various variable types and a column for their values</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>##   variable value
## 1    Ozone    41
## 2    Ozone    36
## 3    Ozone    12
## 4    Ozone    18
## 5    Ozone    NA
## 6    Ozone    28
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     variable value
## 200     Wind  14.9
## 201     Wind  20.7
## 202     Wind   9.2
## 203     Wind  11.5
## 204     Wind  10.3
## 205     Wind   6.3
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     variable value
## 454     Temp    63
## 455     Temp    70
## 456     Temp    77
## 457     Temp    75
## 458     Temp    76
## 459     Temp    68
</code></pre>
</div>

<hr />

<h3 id="helpful-for-plotting-data">Helpful for plotting data</h3>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">airqual.long</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_boxplot</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<p><img src="/R-Tutorials-1/figure/source/2016-10-11-tutorial-5-data-manipulation-reporting/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6" /></p>

<hr />

<h2 id="melt-wide-to-long">Melt: wide to long</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">airqual.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">melt</span><span class="p">(</span><span class="n">airquality</span><span class="p">,</span><span class="w"> </span><span class="n">id.vars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Day"</span><span class="p">),</span><span class="w">
  </span><span class="n">variable.name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"climate_variable"</span><span class="p">,</span><span class="w"> 
  </span><span class="n">value.name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"climate_value"</span><span class="p">)</span><span class="w">
  
</span><span class="n">head</span><span class="p">(</span><span class="n">airqual.long</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   Month Day climate_variable climate_value
## 1     5   1            Ozone            41
## 2     5   2            Ozone            36
## 3     5   3            Ozone            12
## 4     5   4            Ozone            18
## 5     5   5            Ozone            NA
## 6     5   6            Ozone            28
</code></pre>
</div>

<ul>
  <li>must include which variables you would like to maintain in wide format using <code class="highlighter-rouge">id.vars</code></li>
</ul>

<hr />

<h2 id="cast-long-to-wide">Cast: long to wide</h2>

<p><img src="/R-Tutorials-1/figure/source/2016-10-11-tutorial-5-data-manipulation-reporting/dcast-illustration.png" alt="Caption for the picture." /></p>

<hr />

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">dcast</span><span class="p">(</span><span class="n">airqual.long</span><span class="p">,</span><span class="w"> </span><span class="n">Month</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Day</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">climate_variable</span><span class="p">,</span><span class="w"> </span><span class="n">value.var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"climate_value"</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   Month Day Ozone Solar.R Wind Temp
## 1     5   1    41     190  7.4   67
## 2     5   2    36     118  8.0   72
## 3     5   3    12     149 12.6   74
## 4     5   4    18     313 11.5   62
## 5     5   5    NA      NA 14.3   56
## 6     5   6    28      NA 14.9   66
</code></pre>
</div>

<hr />

<h2 id="references">References</h2>

<ol>
  <li><a href="http://seananderson.ca/2013/10/19/reshape.html">An Introduction to reshape2 - Sean Anderson</a></li>
</ol>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/10/03/tutorial-4-regression.html">
        Tutorial 4 - Regression
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/10/03/tutorial-4-regression.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">03 Oct 2016</span>

    <h2 id="single-and-multiple-regression">Single and Multiple Regression</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 4 <br />
   MIE 1402</p>

<hr />

<h2 id="what-is-regression">What is regression?</h2>

<ul>
  <li>simply put, predicting one variable from another (or &gt; 1)</li>
  <li>we fit our data to some sort of model</li>
  <li>from this model, we can predict the outcome from any predictor data</li>
</ul>

<hr />

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Year</span><span class="p">,</span><span class="w"> </span><span class="n">Employed</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<p><img src="/R-Tutorials-1/figure/source/2016-10-03-tutorial-4-regression/unnamed-chunk-2-1.png" alt="plot of chunk unnamed-chunk-2" /></p>

<hr />

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Year</span><span class="p">,</span><span class="w"> </span><span class="n">Employed</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">"lm"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/R-Tutorials-1/figure/source/2016-10-03-tutorial-4-regression/unnamed-chunk-3-1.png" alt="plot of chunk unnamed-chunk-3" /></p>

<hr />

<h2 id="data-we-are-using-today">Data we are using today</h2>

<style type="text/css">
table { width: 100%; font-size: 11}
</style>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span><span class="w">
</span><span class="n">kable</span><span class="p">(</span><span class="n">head</span><span class="p">(</span><span class="n">longley</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: right">GNP.deflator</th>
      <th style="text-align: right">GNP</th>
      <th style="text-align: right">Unemployed</th>
      <th style="text-align: right">Armed.Forces</th>
      <th style="text-align: right">Population</th>
      <th style="text-align: right">Year</th>
      <th style="text-align: right">Employed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1947</td>
      <td style="text-align: right">83.0</td>
      <td style="text-align: right">234.289</td>
      <td style="text-align: right">235.6</td>
      <td style="text-align: right">159.0</td>
      <td style="text-align: right">107.608</td>
      <td style="text-align: right">1947</td>
      <td style="text-align: right">60.323</td>
    </tr>
    <tr>
      <td style="text-align: left">1948</td>
      <td style="text-align: right">88.5</td>
      <td style="text-align: right">259.426</td>
      <td style="text-align: right">232.5</td>
      <td style="text-align: right">145.6</td>
      <td style="text-align: right">108.632</td>
      <td style="text-align: right">1948</td>
      <td style="text-align: right">61.122</td>
    </tr>
    <tr>
      <td style="text-align: left">1949</td>
      <td style="text-align: right">88.2</td>
      <td style="text-align: right">258.054</td>
      <td style="text-align: right">368.2</td>
      <td style="text-align: right">161.6</td>
      <td style="text-align: right">109.773</td>
      <td style="text-align: right">1949</td>
      <td style="text-align: right">60.171</td>
    </tr>
    <tr>
      <td style="text-align: left">1950</td>
      <td style="text-align: right">89.5</td>
      <td style="text-align: right">284.599</td>
      <td style="text-align: right">335.1</td>
      <td style="text-align: right">165.0</td>
      <td style="text-align: right">110.929</td>
      <td style="text-align: right">1950</td>
      <td style="text-align: right">61.187</td>
    </tr>
    <tr>
      <td style="text-align: left">1951</td>
      <td style="text-align: right">96.2</td>
      <td style="text-align: right">328.975</td>
      <td style="text-align: right">209.9</td>
      <td style="text-align: right">309.9</td>
      <td style="text-align: right">112.075</td>
      <td style="text-align: right">1951</td>
      <td style="text-align: right">63.221</td>
    </tr>
    <tr>
      <td style="text-align: left">1952</td>
      <td style="text-align: right">98.1</td>
      <td style="text-align: right">346.999</td>
      <td style="text-align: right">193.2</td>
      <td style="text-align: right">359.4</td>
      <td style="text-align: right">113.270</td>
      <td style="text-align: right">1952</td>
      <td style="text-align: right">63.639</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="examine-the-data">Examine the data</h2>
<ul>
  <li>missing data?</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">na.omit</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<hr />

<h2 id="examine-the-data-1">Examine the data</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># data types 
</span><span class="n">str</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 'data.frame':	16 obs. of  7 variables:
##  $ GNP.deflator: num  83 88.5 88.2 89.5 96.2 ...
##  $ GNP         : num  234 259 258 285 329 ...
##  $ Unemployed  : num  236 232 368 335 210 ...
##  $ Armed.Forces: num  159 146 162 165 310 ...
##  $ Population  : num  108 109 110 111 112 ...
##  $ Year        : int  1947 1948 1949 1950 1951 1952 1953 1954 1955 1956 ...
##  $ Employed    : num  60.3 61.1 60.2 61.2 63.2 ...
</code></pre>
</div>

<hr />
<p>## Examine the data</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># descriptive statistics
</span><span class="n">stat.desc</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span><span class="w"> </span><span class="n">basic</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##              GNP.deflator          GNP   Unemployed Armed.Forces
## median        100.6000000  381.4270000  314.3500000  271.7500000
## mean          101.6812500  387.6984375  319.3312500  260.6687500
## SE.mean         2.6978884   24.8487344   23.3616062   17.3979901
## CI.mean.0.95    5.7504129   52.9638237   49.7940849   37.0829381
## var           116.4576250 9879.3536593 8732.2342917 4843.0409583
## std.dev        10.7915534   99.3949378   93.4464247   69.5919604
## coef.var        0.1061312    0.2563718    0.2926316    0.2669747
##                Population         Year    Employed
## median       116.80350000 1.954500e+03 65.50400000
## mean         117.42400000 1.954500e+03 65.31700000
## SE.mean        1.73902539 1.190238e+00  0.87799209
## CI.mean.0.95   3.70664488 2.536932e+00  1.87139584
## var           48.38734893 2.266667e+01 12.33392173
## std.dev        6.95610156 4.760952e+00  3.51196836
## coef.var       0.05923918 2.435893e-03  0.05376806
</code></pre>
</div>

<p>— &amp;two-col</p>

<p>***{name: left}</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span><span class="w">
</span><span class="n">pairs.panels</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/R-Tutorials-1/figure/source/2016-10-03-tutorial-4-regression/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8" /></p>

<style type="text/css">
.right {
    position: fixed;
    bottom: -500px;
    right: 0;}
</style>

<p><strong>*{name: right}
- bivariate scatter plots below the diagonal
- histograms on the diagonal
- Pearson correlation above the diagonal
- **also should be checking assumptions</strong></p>

<hr />
<p>## Simple regression</p>

<ul>
  <li>one independent variable</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">lm.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">Employed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">GNP</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">longley</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">lm.1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## lm(formula = Employed ~ GNP, data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.77958 -0.55440 -0.00944  0.34361  1.44594 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 51.843590   0.681372   76.09  &lt; 2e-16 ***
## GNP          0.034752   0.001706   20.37 8.36e-12 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6566 on 14 degrees of freedom
## Multiple R-squared:  0.9674,	Adjusted R-squared:  0.965 
## F-statistic: 415.1 on 1 and 14 DF,  p-value: 8.363e-12
</code></pre>
</div>

<hr />

<h2 id="interpreting-the-output">Interpreting the output</h2>

<ul>
  <li>Multiple/adjusted R squared: square of the correlation between GNP and Employment</li>
  <li>How well does the model explain the variance in the data?</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="nf">round</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="m">0.9674</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 0.9836
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="nf">round</span><span class="p">(</span><span class="n">cor</span><span class="p">(</span><span class="n">longley</span><span class="o">$</span><span class="n">GNP</span><span class="p">,</span><span class="w"> </span><span class="n">longley</span><span class="o">$</span><span class="n">Employed</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 0.9836
</code></pre>
</div>

<ul>
  <li>tells us that GNP accounts for 98% of variation in Employment</li>
</ul>

<hr />

<h2 id="interpreting-the-output-1">Interpreting the output</h2>

<ul>
  <li>F-statistic is significant at $p &lt; .001$
    <ul>
      <li>tells us there is less than a 0.1% chance that an F-ratio this large would happen if the null hypothesis were true</li>
      <li>GNP predicts employment significantly well</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="multiple-regression">Multiple regression</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">lm.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">Employed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">GNP.deflator</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GNP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Unemployed</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Armed.Forces</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Population</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Year</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">longley</span><span class="p">)</span><span class="w"> 

</span><span class="n">lm.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">Employed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">longley</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<hr />

<h2 id="multiple-regression-1">Multiple regression</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Call:
## lm(formula = Employed ~ ., data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.41011 -0.15767 -0.02816  0.10155  0.45539 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -3.482e+03  8.904e+02  -3.911 0.003560 ** 
## GNP.deflator  1.506e-02  8.492e-02   0.177 0.863141    
## GNP          -3.582e-02  3.349e-02  -1.070 0.312681    
## Unemployed   -2.020e-02  4.884e-03  -4.136 0.002535 ** 
## Armed.Forces -1.033e-02  2.143e-03  -4.822 0.000944 ***
## Population   -5.110e-02  2.261e-01  -0.226 0.826212    
## Year          1.829e+00  4.555e-01   4.016 0.003037 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3049 on 9 degrees of freedom
## Multiple R-squared:  0.9955,	Adjusted R-squared:  0.9925 
## F-statistic: 330.3 on 6 and 9 DF,  p-value: 4.984e-10
</code></pre>
</div>

<ul>
  <li>estimates of the formula ($b_{0}, b_{1}, b_{2}$…)</li>
  <li>confidence (probability that the estimate is wrong)</li>
</ul>

<hr />

<ul>
  <li>Again we can look at $R^2$, $F$-ratio to understand the fit of our model</li>
  <li>Use standardized beta to compare predictors
    <ul>
      <li>removes issue of units</li>
      <li>bigger absolute value, more important</li>
    </ul>
  </li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">QuantPsyc</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">lm.beta</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
##   0.04628202  -1.01374635  -0.53754258  -0.20474069  -0.10122111 
##         Year 
##   2.47966438
</code></pre>
</div>

<hr />

<h2 id="how-do-we-decide-which-variables-to-keep-and-in-what-order">How do we decide which variables to keep, and in what order?</h2>

<p><strong>Hierarchical regression</strong>
- based on previous research
- known predictors entered into model first</p>

<p><strong>Forced entry regression</strong>
- all at once</p>

<p><strong>Stepwise regression</strong>
- not generally appropriate
- looks for the predictor variable that ‘best’ explains variance in the data
- perform cross-valdiation if you use stepwise methods</p>

<hr />

<h2 id="assessing-the-model">Assessing the model</h2>

<ul>
  <li>If you use hierarchical regression, you can compare improvement at each stage of analysis by looking at the change in $R^2$, and testing if that change is significant using:</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">anova</span><span class="p">(</span><span class="n">lm.1</span><span class="p">,</span><span class="w"> </span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Analysis of Variance Table
## 
## Model 1: Employed ~ GNP
## Model 2: Employed ~ GNP.deflator + GNP + Unemployed + Armed.Forces + Population + 
##     Year
##   Res.Df    RSS Df Sum of Sq     F   Pr(&gt;F)   
## 1     14 6.0361                               
## 2      9 0.8364  5    5.1997 11.19 0.001186 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre>
</div>

<hr />

<h2 id="assessing-the-model-1">Assessing the model</h2>

<ul>
  <li>case-wise diagnostics looks at individual rows (or ‘cases’) in the data to assess outliers, influential cases, etc</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">rstandard</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span><span class="n">rstudent</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span><span class="n">cooks.distance</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span><span class="n">dfbeta</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span><span class="n">dffits</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span><span class="n">hatvalues</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span><span class="n">covratio</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<ul>
  <li>each criterion has it’s own assumptions &amp; bounds (Andy Field, 7.9.2)</li>
</ul>

<hr />

<h2 id="assessing-the-model-2">Assessing the model</h2>

<ul>
  <li>no multicollinearity</li>
  <li>exists when there is strong correlation between predictor variables</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">cor</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##              GNP.deflator       GNP Unemployed Armed.Forces Population
## GNP.deflator    1.0000000 0.9915892  0.6206334    0.4647442  0.9791634
## GNP             0.9915892 1.0000000  0.6042609    0.4464368  0.9910901
## Unemployed      0.6206334 0.6042609  1.0000000   -0.1774206  0.6865515
## Armed.Forces    0.4647442 0.4464368 -0.1774206    1.0000000  0.3644163
## Population      0.9791634 0.9910901  0.6865515    0.3644163  1.0000000
## Year            0.9911492 0.9952735  0.6682566    0.4172451  0.9939528
## Employed        0.9708985 0.9835516  0.5024981    0.4573074  0.9603906
##                   Year  Employed
## GNP.deflator 0.9911492 0.9708985
## GNP          0.9952735 0.9835516
## Unemployed   0.6682566 0.5024981
## Armed.Forces 0.4172451 0.4573074
## Population   0.9939528 0.9603906
## Year         1.0000000 0.9713295
## Employed     0.9713295 1.0000000
</code></pre>
</div>

<hr />

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">vif</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w"> </span><span class="c1"># problem if largest VIF is &gt; 10
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
##    135.53244   1788.51348     33.61889      3.58893    399.15102 
##         Year 
##    758.98060
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">mean</span><span class="p">(</span><span class="n">vif</span><span class="p">(</span><span class="n">lm.2</span><span class="p">))</span><span class="w"> </span><span class="c1"># regression may be biased if substantially &gt; 1
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 519.8976
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="m">1</span><span class="o">/</span><span class="n">vif</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w"> </span><span class="c1"># problem if tolerance &lt; 0.1
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
## 0.0073783075 0.0005591235 0.0297451814 0.2786345641 0.0025053174 
##         Year 
## 0.0013175567
</code></pre>
</div>

<hr />

<h2 id="assessing-the-model-3">Assessing the model</h2>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">lm.2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>
<p>Plot 1: Residuals vs Fitted
- how close is the line to horizontal? (normality)
- are there outliers?</p>

<p>Plot 2: Q-Q plot
- how close is the line to the diagonal?</p>

<p>Plot 3: Standardized residuals vs fitted values
- if dots are not spread out evenly, may have violation of assumption of variance (funnel) or asummption of linearity (curve)</p>

<p>Plot 4: Cook distances
- identifies extreme values
- demonstrates which points have influence over model</p>

<hr />

<h2 id="what-now">What now?</h2>

<ul>
  <li>Remove highly correlated predictors from the model</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">longley.uncor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"GNP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Unemployed"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Armed.Forces"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Employed"</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<ul>
  <li>Remove outliers</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">longley.rm_outliers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span><span class="w"> </span><span class="n">Year</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">1951</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<ul>
  <li>Use Principal Components Analysis to reduce set</li>
</ul>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">principal</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">rotate</span><span class="o">=</span><span class="s2">"oblimin"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<hr />


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/09/27/tutorial-3-feature-segment.html">
        Tutorial 3 - Feature Extraction and Segmentation
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/09/27/tutorial-3-feature-segment.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">27 Sep 2016</span>

    <h2 id="feature-extraction-and-segmentation">Feature Extraction and Segmentation</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 3<br />
   MIE 1402</p>

<hr />

<h2 id="exploratory-factor-analysis">Exploratory factor analysis</h2>

<ul>
  <li>We’ll use the iris data again</li>
  <li>Simple dataset, usually you would use this technique for data that has many variables that you would like to condense or explore relationships</li>
</ul>

<style type="text/css">
table { width: 90%; font-size: 24}
</style>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Sepal.Length</th>
      <th style="text-align: center">Sepal.Width</th>
      <th style="text-align: center">Petal.Length</th>
      <th style="text-align: center">Petal.Width</th>
      <th style="text-align: center">Species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">5.1</td>
      <td style="text-align: center">3.5</td>
      <td style="text-align: center">1.4</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">4.9</td>
      <td style="text-align: center">3.0</td>
      <td style="text-align: center">1.4</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">4.7</td>
      <td style="text-align: center">3.2</td>
      <td style="text-align: center">1.3</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">4.6</td>
      <td style="text-align: center">3.1</td>
      <td style="text-align: center">1.5</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">5.0</td>
      <td style="text-align: center">3.6</td>
      <td style="text-align: center">1.4</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">5.4</td>
      <td style="text-align: center">3.9</td>
      <td style="text-align: center">1.7</td>
      <td style="text-align: center">0.4</td>
      <td style="text-align: center">setosa</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="extract-the-same-number-of-factors-as-variables">1. Extract the same number of factors as variables</h3>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">pc1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">principal</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">pc1</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Principal Components Analysis
## Call: principal(r = iris[1:4], nfactors = 4)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                RC1   RC3   RC2   RC4 h2       u2 com
## Sepal.Length  0.53  0.85  0.00  0.00  1  1.1e-16 1.7
## Sepal.Width  -0.17 -0.04  0.98 -0.01  1  4.4e-16 1.1
## Petal.Length  0.78  0.54 -0.28  0.14  1 -4.4e-16 2.2
## Petal.Width   0.89  0.41 -0.20 -0.06  1  0.0e+00 1.5
## 
##                        RC1  RC3  RC2  RC4
## SS loadings           1.71 1.18 1.09 0.02
## Proportion Var        0.43 0.30 0.27 0.01
## Cumulative Var        0.43 0.72 0.99 1.00
## Proportion Explained  0.43 0.30 0.27 0.01
## Cumulative Proportion 0.43 0.72 0.99 1.00
## 
## Mean item complexity =  1.6
## Test of the hypothesis that 4 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0 
##  with the empirical chi square  0  with prob &lt;  NA 
## 
## Fit based upon off diagonal values = 1</code></pre></figure>

<hr />

<h3 id="examine-scree-plot">2. Examine scree plot</h3>
<ul>
  <li>Eigenvalues plotted against the factor number</li>
  <li>Look for point of inflection (“elbow”)</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="p">(</span><span class="n">pc1</span><span class="o">$</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"b"</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-3-feature-segment/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4" /></p>

<hr />

<h3 id="choose-number-of-factors-to-extract">3. Choose number of factors to extract</h3>

<ul>
  <li>Look at eigenvalues (Kaiser’s criterion &gt; 1, Jolliffe’s criterion &gt; 0.7)</li>
  <li>Examine scree plot</li>
  <li>May be theoretical</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">pc2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">principal</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">pc2</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Principal Components Analysis
## Call: principal(r = iris[1:4], nfactors = 2)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                RC1   RC2   h2     u2 com
## Sepal.Length  0.96  0.05 0.92 0.0774 1.0
## Sepal.Width  -0.14  0.98 0.99 0.0091 1.0
## Petal.Length  0.94 -0.30 0.98 0.0163 1.2
## Petal.Width   0.93 -0.26 0.94 0.0647 1.2
## 
##                        RC1  RC2
## SS loadings           2.70 1.13
## Proportion Var        0.68 0.28
## Cumulative Var        0.68 0.96
## Proportion Explained  0.71 0.29
## Cumulative Proportion 0.71 1.00
## 
## Mean item complexity =  1.1
## Test of the hypothesis that 2 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.03 
##  with the empirical chi square  1.72  with prob &lt;  NA 
## 
## Fit based upon off diagonal values = 1</code></pre></figure>

<hr />

<h3 id="decide-whether-to-use-rotation">4. Decide whether to use rotation</h3>

<ul>
  <li>Orthogonal or oblique</li>
  <li>Does it make sense theoretically?</li>
  <li>Does it improve things?</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">pc3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">principal</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">rotate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"oblimin"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Loading required namespace: GPArotation</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">pc3</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Principal Components Analysis
## Call: principal(r = iris[1:4], nfactors = 2, rotate = "oblimin")
## Standardized loadings (pattern matrix) based upon correlation matrix
##                TC1   TC2   h2     u2 com
## Sepal.Length  1.00  0.20 0.92 0.0774 1.1
## Sepal.Width  -0.02  0.99 0.99 0.0091 1.0
## Petal.Length  0.94 -0.16 0.98 0.0163 1.1
## Petal.Width   0.93 -0.11 0.94 0.0647 1.0
## 
##                        TC1  TC2
## SS loadings           2.75 1.08
## Proportion Var        0.69 0.27
## Cumulative Var        0.69 0.96
## Proportion Explained  0.72 0.28
## Cumulative Proportion 0.72 1.00
## 
##  With component correlations of 
##       TC1   TC2
## TC1  1.00 -0.27
## TC2 -0.27  1.00
## 
## Mean item complexity =  1
## Test of the hypothesis that 2 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.03 
##  with the empirical chi square  1.72  with prob &lt;  NA 
## 
## Fit based upon off diagonal values = 1</code></pre></figure>

<hr />

<h2 id="segmentation-cluster-analysis">Segmentation: Cluster Analysis</h2>

<ul>
  <li>Unsupervised learning algorithm that tries to cluster data based on their similarity</li>
  <li>Again, we’ll use the iris data</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">Petal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-3-feature-segment/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8" /></p>

<hr />

<h2 id="clustering-in-r">Clustering in R</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">set.seed</span><span class="p">(</span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">irisCluster</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">kmeans</span><span class="p">(</span><span class="n">iris</span><span class="p">[,</span><span class="w"> </span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">nstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">irisCluster</span><span class="o">$</span><span class="n">centers</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##   Petal.Length Petal.Width
## 1     1.462000    0.246000
## 2     4.269231    1.342308
## 3     5.595833    2.037500</code></pre></figure>

<ul>
  <li>nstart is the number of random starting assignments</li>
  <li>R then selects the one the with lowest within-cluster variation</li>
  <li>we use the set.seed() function to ensure that we get the same randon value when we re-run the code</li>
</ul>

<p>— &amp;two-col</p>

<p>***{name: left}</p>

<p>Cluster assignments vs actual species</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">setosa</th>
      <th style="text-align: right">versicolor</th>
      <th style="text-align: right">virginica</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">50</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
    </tr>
    <tr>
      <td style="text-align: right">0</td>
      <td style="text-align: right">48</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: right">0</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">46</td>
    </tr>
  </tbody>
</table>

<p>***{name: right}</p>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-3-feature-segment/unnamed-chunk-11-1.png" alt="plot of chunk unnamed-chunk-11" /></p>

<hr />

<h2 id="references">References</h2>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

<p><a href="https://www.r-bloggers.com/k-means-clustering-in-r/">https://www.r-bloggers.com/k-means-clustering-in-r/</a></p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/09/27/tutorial-2-assumptions-cor.html">
        Tutorial 2 - Parametric assumptions and correlations
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/09/27/tutorial-2-assumptions-cor.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">27 Sep 2016</span>

    <h2 id="parametric-assumptions--correlations">Parametric Assumptions &amp; Correlations</h2>

<p><strong>Jenna Blumenthal</strong><br />
   Tutorial #: 2<br />
   MIE 1402</p>

<hr />

<h2 id="by-now">By now…</h2>

<ul>
  <li>You have R, R Studio installed</li>
  <li>You have played around with it (imported some data, ran some commands)</li>
  <li>You have followed an example from the textbook</li>
</ul>

<hr />

<h2 id="today">Today</h2>

<ol>
  <li>Assumptions
    <ul>
      <li>basis for parametric tests</li>
      <li>normality, homogeneity of variance</li>
    </ul>
  </li>
  <li>Correlations
    <ul>
      <li>general procedure in R</li>
      <li>partial, semi-partial, non-parametric statistics</li>
    </ul>
  </li>
  <li>Assignment 1</li>
</ol>

<p>— .full-width-table</p>

<h2 id="data-we-will-be-using">Data we will be using</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span></code></pre></figure>

<style type="text/css">
table { width: 90%; font-size: 24}
</style>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">kable</span><span class="p">(</span><span class="n">head</span><span class="p">(</span><span class="n">iris</span><span class="p">),</span><span class="w"> </span><span class="n">align</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">)</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Sepal.Length</th>
      <th style="text-align: center">Sepal.Width</th>
      <th style="text-align: center">Petal.Length</th>
      <th style="text-align: center">Petal.Width</th>
      <th style="text-align: center">Species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">5.1</td>
      <td style="text-align: center">3.5</td>
      <td style="text-align: center">1.4</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">4.9</td>
      <td style="text-align: center">3.0</td>
      <td style="text-align: center">1.4</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">4.7</td>
      <td style="text-align: center">3.2</td>
      <td style="text-align: center">1.3</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">4.6</td>
      <td style="text-align: center">3.1</td>
      <td style="text-align: center">1.5</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">5.0</td>
      <td style="text-align: center">3.6</td>
      <td style="text-align: center">1.4</td>
      <td style="text-align: center">0.2</td>
      <td style="text-align: center">setosa</td>
    </tr>
    <tr>
      <td style="text-align: center">5.4</td>
      <td style="text-align: center">3.9</td>
      <td style="text-align: center">1.7</td>
      <td style="text-align: center">0.4</td>
      <td style="text-align: center">setosa</td>
    </tr>
  </tbody>
</table>

<p>— &amp;two-col</p>

<h2 id="assumption-of-parametric-data">Assumption of parametric data</h2>
<p>Most stats we are used are parametric tests, based on the normal distribution.</p>

<p>*** {name: left}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">25</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-3-1.png" alt="plot of chunk unnamed-chunk-3" /></p>

<p>*** {name: right}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">shapiro.test</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 
## 	Shapiro-Wilk normality test
## 
## data:  iris$Sepal.Width
## W = 0.98492, p-value = 0.1012</code></pre></figure>

<p>— &amp;two-col</p>

<h3 id="step-1-visual-inspection">Step 1: Visual Inspection</h3>

<p>Normal</p>

<p>*** {name: left}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">25</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-5-1.png" alt="plot of chunk unnamed-chunk-5" /></p>

<p>*** {name: right}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">qplot</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6" /></p>

<p>— &amp;two-col</p>

<h3 id="step-1-visual-inspection-1">Step 1: Visual Inspection</h3>

<p>Positive skew</p>

<p>*** {name: left}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Petal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7" /></p>

<p>*** {name: right}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">qplot</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8" /></p>

<p>— &amp;two-col</p>

<h3 id="step-1-visual-inspection-2">Step 1: Visual Inspection</h3>

<p>Negative kurtosis (platykurtic)</p>

<p>*** {name: left}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-9-1.png" alt="plot of chunk unnamed-chunk-9" /></p>

<p>*** {name: right}</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">qplot</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-10-1.png" alt="plot of chunk unnamed-chunk-10" /></p>

<p>— &amp;two-col</p>

<h3 id="step-2-numeric">Step 2: Numeric</h3>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">pastecs</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-13-1.png" alt="plot of chunk unnamed-chunk-13" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="nf">round</span><span class="p">(</span><span class="n">stat.desc</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##      nbr.val     nbr.null       nbr.na          min          max 
##       150.00         0.00         0.00         2.00         4.40 
##        range          sum       median         mean      SE.mean 
##         2.40       458.60         3.00         3.06         0.04 
## CI.mean.0.95          var      std.dev     coef.var     skewness 
##         0.07         0.19         0.44         0.14         0.31 
##     skew.2SE     kurtosis     kurt.2SE   normtest.W   normtest.p 
##         0.79         0.14         0.18         0.98         0.10</code></pre></figure>

<hr />

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-15-1.png" alt="plot of chunk unnamed-chunk-15" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="nf">round</span><span class="p">(</span><span class="n">stat.desc</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##      nbr.val     nbr.null       nbr.na          min          max 
##       150.00         0.00         0.00         1.00         6.90 
##        range          sum       median         mean      SE.mean 
##         5.90       563.70         4.35         3.76         0.14 
## CI.mean.0.95          var      std.dev     coef.var     skewness 
##         0.28         3.12         1.77         0.47        -0.27 
##     skew.2SE     kurtosis     kurt.2SE   normtest.W   normtest.p 
##        -0.68        -1.42        -1.80         0.88         0.00</code></pre></figure>

<hr />

<h3 id="step-3-statistical-tests">Step 3: Statistical tests</h3>

<h4 id="normal-distribution">Normal distribution</h4>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">shapiro.test</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 
## 	Shapiro-Wilk normality test
## 
## data:  iris$Sepal.Width
## W = 0.98492, p-value = 0.1012</code></pre></figure>

<hr />

<h4 id="non-normal-distribution">Non-normal distribution…</h4>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">shapiro.test</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 
## 	Shapiro-Wilk normality test
## 
## data:  iris$Sepal.Length
## W = 0.97609, p-value = 0.01018</code></pre></figure>

<hr />

<h4 id="unless-grouped-by-species">…Unless grouped by species</h4>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">by</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">shapiro.test</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## iris$Species: setosa
## 
## 	Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.9777, p-value = 0.4595
## 
## ---------------------------------------------------- 
## iris$Species: versicolor
## 
## 	Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.97784, p-value = 0.4647
## 
## ---------------------------------------------------- 
## iris$Species: virginica
## 
## 	Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.97118, p-value = 0.2583</code></pre></figure>

<hr />

<h2 id="testing-for-homogeneity-of-variance">Testing for homogeneity of variance</h2>

<p>Variance in each population is equal</p>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-20-1.png" alt="plot of chunk unnamed-chunk-20" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">leveneTest</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Levene's Test for Homogeneity of Variance (center = median)
##        Df F value Pr(&gt;F)
## group   2  0.5902 0.5555
##       147</code></pre></figure>

<hr />

<p>Variance in each population is not equal</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Species</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">Petal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_boxplot</span><span class="p">()</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-23-1.png" alt="plot of chunk unnamed-chunk-23" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">leveneTest</span><span class="p">(</span><span class="n">Petal.Width</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Levene's Test for Homogeneity of Variance (center = median)
##        Df F value        Pr(&gt;F)    
## group   2  19.892 0.00000002261 ***
##       147                          
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre></figure>

<hr />

<h2 id="correlation">Correlation</h2>

<p>Standardized covariance
<script type="math/tex">r = \frac{cov_{xy}}{s_{x}s_{y}}</script></p>

<hr />

<h2 id="correlation-in-r">Correlation in r</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cor.test</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pearson"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 
## 	Pearson's product-moment correlation
## 
## data:  iris$Petal.Length and iris$Petal.Width
## t = 43.387, df = 148, p-value &lt; 0.00000000000000022
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9490525 0.9729853
## sample estimates:
##       cor 
## 0.9628654</code></pre></figure>

<hr />

<h3 id="plotting-the-correlation-and-line-of-best-fit">Plotting the correlation and line of best fit</h3>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-27-tutorial-2-assumptions-cor/unnamed-chunk-25-1.png" alt="plot of chunk unnamed-chunk-25" /></p>

<hr />

<h2 id="partial-semi-partial-non-parametric">Partial, Semi-Partial, Non-parametric</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">ggm</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cor</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 0.8717538</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">pcor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"Petal.Length"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Sepal.Length"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Petal.Width"</span><span class="p">),</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">iris</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 0.5420163</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cor.test</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"spearman"</span><span class="p">)</span><span class="w">
</span><span class="n">cor.test</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"kendall"</span><span class="p">)</span></code></pre></figure>

<hr />

<h2 id="references">References</h2>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/R-Tutorials-1//2016/09/15/tutorial-1-intro-to-r.html">
        Tutorial 1 - Introduction to R
      </a>
    </h1>
    
<a href="/R-Tutorials-1/2016/09/15/tutorial-1-intro-to-r.html#disqus_thread"
    class = "commentcount"></a>
    
    <span class="post-date">15 Sep 2016</span>

    <p>— .intro-slide</p>

<h2 id="introduction-to-r">Introduction to R</h2>

<p><strong>Jenna Blumenthal</strong><br />
   MIE 1402</p>

<hr />

<h2 id="what-is-r">What is R?</h2>

<ul>
  <li>Language &amp; environment for statistical computing</li>
  <li>Widely used by statisticians, data miners</li>
  <li>Popular among academics &amp; industry</li>
</ul>

<hr />

<h2 id="what-is-it-used-for">What is it used for?</h2>

<ul>
  <li>Data handling, organizing</li>
  <li>Basic mathematical operations</li>
  <li>Linear, nonlinear modeling, classical stats tests, time-series analysis, classification, clustering, etc</li>
  <li>Publication-quality graphics</li>
</ul>

<hr />

<h2 id="what-makes-r-so-great">What makes R so great?</h2>

<ul>
  <li>Open source (i.e. free)</li>
  <li>Highly extensible (user-submitted <strong>packages</strong>)
    <ul>
      <li>Functions available for very specific areas</li>
    </ul>
  </li>
  <li>Excellent documentation</li>
  <li>Great graphics
    <ul>
      <li>Publication-quality graphs (<code class="highlighter-rouge">ggplot2</code>)</li>
      <li>RMarkdown, LaTeX (write reports without copying and pasting)</li>
      <li>Shiny (interative data visualizations, etc.)</li>
    </ul>
  </li>
  <li>Reproducible analysis</li>
</ul>

<hr />

<h2 id="what-are-some-other-options">What are some other options?</h2>

<ul>
  <li>SAS, SPSS, Stata, MATLAB, etc…</li>
  <li>Not so free</li>
  <li>Not so open-source (meaning there is a smaller community to help when you get stuck)</li>
</ul>

<hr />

<h2 id="getting-set-up">Getting set up</h2>

<h3 id="what-youll-need">What you’ll need</h3>

<p>R: <a href="http://www.r-project.org/">http://www.r-project.org/</a></p>

<h3 id="what-youll-want">What you’ll want</h3>
<p>RStudio (highly recommended GUI): <a href="https://www.rstudio.com/">https://www.rstudio.com/</a></p>

<p>LaTeX (good for report-writing): <a href="https://www.latex-project.org/">https://www.latex-project.org/</a></p>

<p>Git (good for version control): <a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a></p>

<hr />

<h2 id="rstudio">RStudio</h2>

<p><img src="../../../../R-Tutorials-1/assets/img/RStudio_screenshot.png" alt="" /></p>

<hr />

<h3 id="console">Console</h3>
<ul>
  <li>Command-line interface</li>
  <li>Type after the <code class="highlighter-rouge">&gt;</code> prompt and R will execute your command</li>
  <li>This is where R does the stuff</li>
</ul>

<h3 id="editor">Editor</h3>
<ul>
  <li>Collection of commands can be edited and saved</li>
  <li><code class="highlighter-rouge">File --&gt; New | File --&gt; Open --&gt; R Script</code></li>
</ul>

<h3 id="environment">Environment</h3>
<ul>
  <li>What data/values R has in its memory</li>
  <li>Good for viewing complex objects</li>
</ul>

<h3 id="files-packages-docs-views">Files, packages, docs, views</h3>
<ul>
  <li>Browse directory, open files, install/load packages, look at documentation (for help), preview graphs, etc.</li>
</ul>

<hr />

<h2 id="getting-started">Getting started</h2>

<p>Before you start being a stats wizard…get organized.</p>

<hr />

<h3 id="working-directory">1. Working directory</h3>

<ul>
  <li>The folder you are currently in</li>
  <li>If you ask R to retrieve a certain file, it will look in the working directory (unless another path is given)</li>
  <li>If you save a file from R, it will save in your working directory (ditto)</li>
  <li>Be careful, sometimes you think you are in the correct wd, but you are not. Double check using:</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">getwd</span><span class="p">()</span></code></pre></figure>

<p>You can change the working directory using</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">setwd</span><span class="p">(</span><span class="s2">"Desktop/ExperimentalMethods/RTutorials"</span><span class="p">)</span></code></pre></figure>

<hr />

<h3 id="install-packagesload-libraries">2. Install packages/load libraries</h3>

<ul>
  <li>The core of what makes R great</li>
  <li>Some useful ones come preloaded, but there are many more</li>
  <li>Andy Field will reference the ones he uses in the textbook</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">install.packages</span><span class="p">(</span><span class="s2">"package-name"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">package</span><span class="o">-</span><span class="n">name</span><span class="p">)</span></code></pre></figure>

<h4 id="notes">Notes</h4>

<ul>
  <li>The first one uses quotes, the second doesn’t. Don’t ask me why.</li>
  <li>Often you figure out you don’t have a package by getting an error.</li>
  <li>Check to see what packages you have installed using</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">()</span></code></pre></figure>

<ul>
  <li>You only have to <strong>install</strong> the package once, but you need to <strong>load</strong> the package every time you set up a new environment.</li>
</ul>

<hr />

<h2 id="some-basic-examples">Some basic examples</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">1+1</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 2</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="w">
</span><span class="n">a</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 4</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">fruit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"apples"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pears"</span><span class="p">,</span><span class="w"> </span><span class="s2">"strawberries"</span><span class="p">)</span></code></pre></figure>

<hr />

<h2 id="data">Data</h2>

<p>There are several ways to import data into your R environment:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Built into R
</span><span class="n">read.csv</span><span class="p">()</span><span class="w">
</span><span class="n">read.delim</span><span class="p">()</span><span class="w">
</span><span class="n">read.table</span><span class="p">()</span><span class="w">

</span><span class="c1"># rio package
</span><span class="n">library</span><span class="p">(</span><span class="n">rio</span><span class="p">)</span><span class="w">
</span><span class="n">import</span><span class="p">()</span><span class="w">

</span><span class="c1"># Base datasets (often used in examples)
</span><span class="n">library</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span><span class="w">
</span><span class="n">mtcars</span></code></pre></figure>

<hr />

<h2 id="viewing--summarizing-etc">Viewing , summarizing, etc</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mtcars</span><span class="w">
</span><span class="n">View</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mtcars</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span><span class="w">
</span><span class="n">mtcars</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w">
</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">beacause</span><span class="w"> </span><span class="n">mtcars</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dataframe</span><span class="o">!</span></code></pre></figure>

<hr />

<h3 id="what-is-a-dataframe">What is a dataframe?</h3>

<p>Sort of like a spreadsheet in Excel, except more fun.
- header contains column names
- note, most functions like to work with dataframes, but others like matrices
- Similar, but different object type
- can generally coerce using</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">as.data.frame</span><span class="p">()</span><span class="w">
</span><span class="n">as.matrix</span><span class="p">()</span></code></pre></figure>

<hr />

<h3 id="diy-dataframe">DIY Dataframe</h3>

<p>Note, I rarely do this. Likely you will be pulling data from another source.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">metallicaNames</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Lars"</span><span class="p">,</span><span class="w"> </span><span class="s2">"James"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Kirk"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rob"</span><span class="p">)</span><span class="w">
</span><span class="n">metallicaAges</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">47</span><span class="p">,</span><span class="w"> </span><span class="m">47</span><span class="p">,</span><span class="w"> </span><span class="m">48</span><span class="p">,</span><span class="w"> </span><span class="m">46</span><span class="p">)</span><span class="w">
</span><span class="n">metallica_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metallicaNames</span><span class="p">,</span><span class="w"> </span><span class="n">Age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metallicaAges</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">metallica_data</span><span class="o">$</span><span class="n">Age</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 47 47 48 46</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mean</span><span class="p">(</span><span class="n">metallica_data</span><span class="o">$</span><span class="n">Age</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 47</code></pre></figure>

<hr />

<h3 id="subsetting-data">Subsetting data</h3>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">metallica_data</span><span class="o">$</span><span class="n">Age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">47</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1]  TRUE  TRUE  TRUE FALSE</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">older_band_members</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">metallica_data</span><span class="p">[</span><span class="n">metallica_data</span><span class="o">$</span><span class="n">Age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">47</span><span class="p">,]</span><span class="w">

</span><span class="c1"># OR use subset (a bit more intuitive)
</span><span class="n">older_band_members</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">metallica_data</span><span class="p">,</span><span class="w"> </span><span class="n">Age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">47</span><span class="p">)</span></code></pre></figure>

<hr />

<h2 id="r-commander">R Commander</h2>

<ul>
  <li>GUI interface</li>
  <li>If you are an SPSS user, it may feel more familiar</li>
  <li>I don’t like it (it used to crash my computer)</li>
</ul>

<hr />

<h2 id="saving">Saving</h2>

<p>If you did some data manipulation and would like to save it as a new file:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">write.table</span><span class="p">()</span><span class="w">
</span><span class="n">write.csv</span><span class="p">(</span><span class="n">metallica_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"MetallicaData.csv"</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">wd</span></code></pre></figure>

<p>Save the R file, <strong>DON’T</strong> save the R workspace</p>

<p>Can also make a <code class="highlighter-rouge">project</code> - helpful for saving the working directory, dataframes, etc.</p>

<hr />

<h2 id="brief-introduction-to-graphs-and-ggplot2">Brief introduction to graphs and <code class="highlighter-rouge">ggplot2</code></h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">hist</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-15-tutorial-1-intro-to-r/unnamed-chunk-16-1.png" alt="plot of chunk unnamed-chunk-16" /></p>

<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">disp</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-15-tutorial-1-intro-to-r/unnamed-chunk-17-1.png" alt="plot of chunk unnamed-chunk-17" /></p>

<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">install.packages</span><span class="p">(</span><span class="s2">"ggplot2"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Warning: package 'ggplot2' was built under R version 3.2.4</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">disp</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-15-tutorial-1-intro-to-r/unnamed-chunk-20-1.png" alt="plot of chunk unnamed-chunk-20" /></p>

<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"This is my awesome graph"</span><span class="p">)</span></code></pre></figure>

<p><img src="/R-Tutorials-1/figure/source/2016-09-15-tutorial-1-intro-to-r/unnamed-chunk-21-1.png" alt="plot of chunk unnamed-chunk-21" /></p>

<p>Note that the <code class="highlighter-rouge">plot</code> object isn’t updating unless it is reassigned</p>

<p>Read Ch 4 for some more examples.</p>

<hr />
<p>## R Markdown</p>

<ul>
  <li>instead of C+P-ing everything</li>
  <li>Write your report, generate results, insert graphs, etc. all in the same file</li>
  <li>A few hours of learning will save LOTS of time</li>
  <li>Turn your analyses into:
    <ul>
      <li>PDF</li>
      <li>Word</li>
      <li>Slides</li>
      <li>HTML (like me!)</li>
      <li>Interactive dashboard</li>
    </ul>
  </li>
  <li>File –&gt; New –&gt; R Markdown (.Rmd file)</li>
  <li>To generate PDF files, you’ll need LaTeX
    <ul>
      <li>Mac: http://www.tug.org/mactex/</li>
      <li>Windows: http://miktex.org/</li>
    </ul>
  </li>
  <li>We will go into syntax, etc in a future tutorial</li>
</ul>

<hr />

<h2 id="more-resources">More resources</h2>

<ul>
  <li>Datacamp: datacamp.com/courses/free-introduction-to-r</li>
  <li>R Markdown: http://rmarkdown.rstudio.com/lesson-1.html</li>
  <li>The textbook is great</li>
</ul>

<hr />

<h2 id="references">References</h2>

<p>Wikipedia:
<a href="https://en.wikipedia.org/wiki/R_(programming_language)">https://en.wikipedia.org/wiki/R_(programming_language)</a></p>

<p>A (very) short introduction to R: 
<a href="https://cran.r-project.org/doc/contrib/Torfs+Brauer-Short-R-Intro.pdf">https://cran.r-project.org/doc/contrib/Torfs+Brauer-Short-R-Intro.pdf</a></p>

<p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

<hr />


  </div>
  
</div>

    </div>

  </body>
</html>

<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  
<html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<title>Tutorial 4 - Regression</title>
	<meta name="description" content="Tutorial 4 - Regression">
	<meta name="author" content="Jenna Blumenthal">
	<meta name="generator" content="slidify" />
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Required stylesheet -->
	<link rel="stylesheet" href="libraries/frameworks/deckjs/core/deck.core.css">
	<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/goto/deck.goto.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/hash/deck.hash.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/menu/deck.menu.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/navigation/deck.navigation.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/scale/deck.scale.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/status/deck.status.css">
<!-- Style theme. More available in /themes/style/  -->
	<link rel="stylesheet" href="libraries/frameworks/deckjs/themes/style/swiss.css">
	
	<!-- Transition theme. More available in /themes/transition/  -->
	<link rel="stylesheet" href="libraries/frameworks/deckjs/themes/transition/horizontal-slide.css">
	<script src="libraries/frameworks/deckjs/modernizr.custom.js"></script>
	
	<!-- LOAD STYLE SHEETS -->
	<link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css">
	
	  
</head>

<body class="deck-container">

  <!-- Begin slides -->
  <section class="slide " id="slide-1">
  <h2>Single and Multiple Regression</h2>
  <p><strong>Jenna Blumenthal</strong><br>
   Tutorial #: 4<br>
   MIE 1402</p>

</section>
<section class="slide " id="slide-2">
  <h2>What is regression?</h2>
  <ul>
<li>simply put, predicting one variable from another (or &gt; 1)</li>
<li>we fit our data to some sort of model</li>
<li>from this model, we can predict the outcome from any predictor data</li>
</ul>

</section>
<section class="slide " id="slide-3">
  
  <pre><code class="r">ggplot(longley, aes(Year, Employed)) + geom_point()
</code></pre>

<p><img src="assets/fig/unnamed-chunk-2-1.png" alt="plot of chunk unnamed-chunk-2"></p>

</section>
<section class="slide " id="slide-4">
  
  <pre><code class="r">ggplot(longley, aes(Year, Employed)) + geom_point() + geom_smooth(method=&quot;lm&quot;)
</code></pre>

<p><img src="assets/fig/unnamed-chunk-3-1.png" alt="plot of chunk unnamed-chunk-3"></p>

</section>
<section class="slide " id="slide-5">
  <h2>Data we are using today</h2>
  <style type="text/css">
table { width: 100%; font-size: 11}
</style>

<pre><code class="r">library(datasets)
kable(head(longley))
</code></pre>

<table><thead>
<tr>
<th align="left"></th>
<th align="right">GNP.deflator</th>
<th align="right">GNP</th>
<th align="right">Unemployed</th>
<th align="right">Armed.Forces</th>
<th align="right">Population</th>
<th align="right">Year</th>
<th align="right">Employed</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1947</td>
<td align="right">83.0</td>
<td align="right">234.289</td>
<td align="right">235.6</td>
<td align="right">159.0</td>
<td align="right">107.608</td>
<td align="right">1947</td>
<td align="right">60.323</td>
</tr>
<tr>
<td align="left">1948</td>
<td align="right">88.5</td>
<td align="right">259.426</td>
<td align="right">232.5</td>
<td align="right">145.6</td>
<td align="right">108.632</td>
<td align="right">1948</td>
<td align="right">61.122</td>
</tr>
<tr>
<td align="left">1949</td>
<td align="right">88.2</td>
<td align="right">258.054</td>
<td align="right">368.2</td>
<td align="right">161.6</td>
<td align="right">109.773</td>
<td align="right">1949</td>
<td align="right">60.171</td>
</tr>
<tr>
<td align="left">1950</td>
<td align="right">89.5</td>
<td align="right">284.599</td>
<td align="right">335.1</td>
<td align="right">165.0</td>
<td align="right">110.929</td>
<td align="right">1950</td>
<td align="right">61.187</td>
</tr>
<tr>
<td align="left">1951</td>
<td align="right">96.2</td>
<td align="right">328.975</td>
<td align="right">209.9</td>
<td align="right">309.9</td>
<td align="right">112.075</td>
<td align="right">1951</td>
<td align="right">63.221</td>
</tr>
<tr>
<td align="left">1952</td>
<td align="right">98.1</td>
<td align="right">346.999</td>
<td align="right">193.2</td>
<td align="right">359.4</td>
<td align="right">113.270</td>
<td align="right">1952</td>
<td align="right">63.639</td>
</tr>
</tbody></table>

</section>
<section class="slide " id="slide-6">
  <h2>Examine the data</h2>
  <ul>
<li>missing data?</li>
</ul>

<pre><code class="r">na.omit(longley)
</code></pre>

</section>
<section class="slide " id="slide-7">
  <h2>Examine the data</h2>
  <pre><code class="r"># data types 
str(longley)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  7 variables:
##  $ GNP.deflator: num  83 88.5 88.2 89.5 96.2 ...
##  $ GNP         : num  234 259 258 285 329 ...
##  $ Unemployed  : num  236 232 368 335 210 ...
##  $ Armed.Forces: num  159 146 162 165 310 ...
##  $ Population  : num  108 109 110 111 112 ...
##  $ Year        : int  1947 1948 1949 1950 1951 1952 1953 1954 1955 1956 ...
##  $ Employed    : num  60.3 61.1 60.2 61.2 63.2 ...
</code></pre>

</section>
<section class="slide " id="slide-8">
  <h2>Examine the data</h2>
  <pre><code class="r"># descriptive statistics
stat.desc(longley, basic=FALSE)
</code></pre>

<pre><code>##              GNP.deflator          GNP   Unemployed Armed.Forces
## median        100.6000000  381.4270000  314.3500000  271.7500000
## mean          101.6812500  387.6984375  319.3312500  260.6687500
## SE.mean         2.6978884   24.8487344   23.3616062   17.3979901
## CI.mean.0.95    5.7504129   52.9638237   49.7940849   37.0829381
## var           116.4576250 9879.3536593 8732.2342917 4843.0409583
## std.dev        10.7915534   99.3949378   93.4464247   69.5919604
## coef.var        0.1061312    0.2563718    0.2926316    0.2669747
##                Population         Year    Employed
## median       116.80350000 1.954500e+03 65.50400000
## mean         117.42400000 1.954500e+03 65.31700000
## SE.mean        1.73902539 1.190238e+00  0.87799209
## CI.mean.0.95   3.70664488 2.536932e+00  1.87139584
## var           48.38734893 2.266667e+01 12.33392173
## std.dev        6.95610156 4.760952e+00  3.51196836
## coef.var       0.05923918 2.435893e-03  0.05376806
</code></pre>

</section>
<section class="slide " id="slide-9">
  
  
<slide class="" id="slide-9">
  <article>
      
    <div class='left' style='float:left;width:48%'>
     <pre><code class="r">library(psych)
pairs.panels(longley)
</code></pre>

<p><img src="assets/fig/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8"></p>

<style type="text/css">
.right {
    position: fixed;
    bottom: -500px;
    right: 0;}
</style>

    </div>    
    <div class='right' style='float:right;width:48%'>
     <ul>
<li>bivariate scatter plots below the diagonal</li>
<li>histograms on the diagonal</li>
<li>Pearson correlation above the diagonal</li>
<li><strong>also should be checking assumptions</strong></li>
</ul>

    </div>
  </article>
</slide>
</section>
<section class="slide " id="slide-10">
  <h2>Simple regression</h2>
  <ul>
<li>one independent variable</li>
</ul>

<pre><code class="r">lm.1 &lt;- lm(Employed ~ GNP, data = longley)
summary(lm.1)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = Employed ~ GNP, data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.77958 -0.55440 -0.00944  0.34361  1.44594 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 51.843590   0.681372   76.09  &lt; 2e-16 ***
## GNP          0.034752   0.001706   20.37 8.36e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6566 on 14 degrees of freedom
## Multiple R-squared:  0.9674, Adjusted R-squared:  0.965 
## F-statistic: 415.1 on 1 and 14 DF,  p-value: 8.363e-12
</code></pre>

</section>
<section class="slide " id="slide-11">
  <h2>Interpreting the output</h2>
  <ul>
<li>Multiple/adjusted R squared: square of the correlation between GNP and Employment</li>
<li>How well does the model explain the variance in the data?</li>
</ul>

<pre><code class="r">round(sqrt(0.9674), 4)
</code></pre>

<pre><code>## [1] 0.9836
</code></pre>

<pre><code class="r">round(cor(longley$GNP, longley$Employed), 4)
</code></pre>

<pre><code>## [1] 0.9836
</code></pre>

<ul>
<li>tells us that GNP accounts for 98% of variation in Employment</li>
</ul>

</section>
<section class="slide " id="slide-12">
  <h2>Interpreting the output</h2>
  <ul>
<li>F-statistic is significant at \(p < .001\)

<ul>
<li>tells us there is less than a 0.1% chance that an F-ratio this large would happen if the null hypothesis were true</li>
<li>GNP predicts employment significantly well</li>
</ul></li>
</ul>

</section>
<section class="slide " id="slide-13">
  <h2>Multiple regression</h2>
  <pre><code class="r">lm.2 &lt;- lm(Employed ~ GNP.deflator + GNP + Unemployed + Armed.Forces + Population + Year, data = longley) 

lm.2 &lt;- lm(Employed ~ ., data = longley)
</code></pre>

</section>
<section class="slide " id="slide-14">
  <h2>Multiple regression</h2>
  <pre><code class="r">summary(lm.2)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = Employed ~ ., data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.41011 -0.15767 -0.02816  0.10155  0.45539 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -3.482e+03  8.904e+02  -3.911 0.003560 ** 
## GNP.deflator  1.506e-02  8.492e-02   0.177 0.863141    
## GNP          -3.582e-02  3.349e-02  -1.070 0.312681    
## Unemployed   -2.020e-02  4.884e-03  -4.136 0.002535 ** 
## Armed.Forces -1.033e-02  2.143e-03  -4.822 0.000944 ***
## Population   -5.110e-02  2.261e-01  -0.226 0.826212    
## Year          1.829e+00  4.555e-01   4.016 0.003037 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3049 on 9 degrees of freedom
## Multiple R-squared:  0.9955, Adjusted R-squared:  0.9925 
## F-statistic: 330.3 on 6 and 9 DF,  p-value: 4.984e-10
</code></pre>

<ul>
<li>estimates of the formula (\(b_{0}, b_{1}, b_{2}\)...)</li>
<li>confidence (probability that the estimate is wrong)</li>
</ul>

</section>
<section class="slide " id="slide-15">
  
  <ul>
<li>Again we can look at \(R^2\), \(F\)-ratio to understand the fit of our model</li>
<li>Use standardized beta to compare predictors

<ul>
<li>removes issue of units</li>
<li>bigger absolute value, more important</li>
</ul></li>
</ul>

<pre><code class="r">library(QuantPsyc)
</code></pre>

<pre><code class="r">lm.beta(lm.2)
</code></pre>

<pre><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
##   0.04628202  -1.01374635  -0.53754258  -0.20474069  -0.10122111 
##         Year 
##   2.47966438
</code></pre>

</section>
<section class="slide " id="slide-16">
  <h2>How do we decide which variables to keep, and in what order?</h2>
  <p><strong>Hierarchical regression</strong></p>

<ul>
<li>based on previous research</li>
<li>known predictors entered into model first</li>
</ul>

<p><strong>Forced entry regression</strong></p>

<ul>
<li>all at once</li>
</ul>

<p><strong>Stepwise regression</strong></p>

<ul>
<li>not generally appropriate</li>
<li>looks for the predictor variable that &#39;best&#39; explains variance in the data</li>
<li>perform cross-valdiation if you use stepwise methods</li>
</ul>

</section>
<section class="slide " id="slide-17">
  <h2>Assessing the model</h2>
  <ul>
<li>If you use hierarchical regression, you can compare improvement at each stage of analysis by looking at the change in \(R^2\), and testing if that change is significant using:</li>
</ul>

<pre><code class="r">anova(lm.1, lm.2)
</code></pre>

<pre><code>## Analysis of Variance Table
## 
## Model 1: Employed ~ GNP
## Model 2: Employed ~ GNP.deflator + GNP + Unemployed + Armed.Forces + Population + 
##     Year
##   Res.Df    RSS Df Sum of Sq     F   Pr(&gt;F)   
## 1     14 6.0361                               
## 2      9 0.8364  5    5.1997 11.19 0.001186 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

</section>
<section class="slide " id="slide-18">
  <h2>Assessing the model</h2>
  <ul>
<li>case-wise diagnostics looks at individual rows (or &#39;cases&#39;) in the data to assess outliers, influential cases, etc</li>
</ul>

<pre><code class="r">rstandard(lm.2)
rstudent(lm.2)
cooks.distance(lm.2)
dfbeta(lm.2)
dffits(lm.2)
hatvalues(lm.2)
covratio(lm.2)
</code></pre>

<ul>
<li>each criterion has it&#39;s own assumptions &amp; bounds (Andy Field, 7.9.2)</li>
</ul>

</section>
<section class="slide " id="slide-19">
  <h2>Assessing the model</h2>
  <ul>
<li>no multicollinearity</li>
<li>exists when there is strong correlation between predictor variables</li>
</ul>

<pre><code class="r">cor(longley)
</code></pre>

<pre><code>##              GNP.deflator       GNP Unemployed Armed.Forces Population
## GNP.deflator    1.0000000 0.9915892  0.6206334    0.4647442  0.9791634
## GNP             0.9915892 1.0000000  0.6042609    0.4464368  0.9910901
## Unemployed      0.6206334 0.6042609  1.0000000   -0.1774206  0.6865515
## Armed.Forces    0.4647442 0.4464368 -0.1774206    1.0000000  0.3644163
## Population      0.9791634 0.9910901  0.6865515    0.3644163  1.0000000
## Year            0.9911492 0.9952735  0.6682566    0.4172451  0.9939528
## Employed        0.9708985 0.9835516  0.5024981    0.4573074  0.9603906
##                   Year  Employed
## GNP.deflator 0.9911492 0.9708985
## GNP          0.9952735 0.9835516
## Unemployed   0.6682566 0.5024981
## Armed.Forces 0.4172451 0.4573074
## Population   0.9939528 0.9603906
## Year         1.0000000 0.9713295
## Employed     0.9713295 1.0000000
</code></pre>

</section>
<section class="slide " id="slide-20">
  
  <pre><code class="r">library(car)
</code></pre>

<pre><code class="r">vif(lm.2) # problem if largest VIF is &gt; 10
</code></pre>

<pre><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
##    135.53244   1788.51348     33.61889      3.58893    399.15102 
##         Year 
##    758.98060
</code></pre>

<pre><code class="r">mean(vif(lm.2)) # regression may be biased if substantially &gt; 1
</code></pre>

<pre><code>## [1] 519.8976
</code></pre>

<pre><code class="r">1/vif(lm.2) # problem if tolerance &lt; 0.1
</code></pre>

<pre><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
## 0.0073783075 0.0005591235 0.0297451814 0.2786345641 0.0025053174 
##         Year 
## 0.0013175567
</code></pre>

</section>
<section class="slide " id="slide-21">
  <h2>Assessing the model</h2>
  <pre><code class="r">plot(lm.2)
</code></pre>

<p>Plot 1: Residuals vs Fitted</p>

<ul>
<li>how close is the line to horizontal? (normality)</li>
<li>are there outliers?</li>
</ul>

<p>Plot 2: Q-Q plot</p>

<ul>
<li>how close is the line to the diagonal?</li>
</ul>

<p>Plot 3: Standardized residuals vs fitted values</p>

<ul>
<li>if dots are not spread out evenly, may have violation of assumption of variance (funnel) or asummption of linearity (curve)</li>
</ul>

<p>Plot 4: Cook distances</p>

<ul>
<li>identifies extreme values</li>
<li>demonstrates which points have influence over model</li>
</ul>

</section>
<section class="slide " id="slide-22">
  <h2>What now?</h2>
  <ul>
<li>Remove highly correlated predictors from the model</li>
</ul>

<pre><code class="r">longley.uncor &lt;- subset(longley, select = c(&quot;GNP&quot;, &quot;Unemployed&quot;, &quot;Armed.Forces&quot;, &quot;Employed&quot;))
</code></pre>

<ul>
<li>Remove outliers</li>
</ul>

<pre><code class="r">longley.rm_outliers &lt;- subset(longley, Year != 1951)
</code></pre>

<ul>
<li>Use Principal Components Analysis to reduce set</li>
</ul>

<pre><code class="r">principal(longley, 3, rotate=&quot;oblimin&quot;)
</code></pre>

</section>
<section class="slide " id="slide-23">
  
  
</section>
</body>
  <!-- deck.navigation snippet -->
  <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
  <a href="#" class="deck-next-link" title="Next">&#8594;</a>
  
  <!-- deck.status snippet -->
  <p class="deck-status">
  <span class="deck-status-current"></span>
    /
  <span class="deck-status-total"></span>
  </p>
  
  <!-- deck.goto snippet -->
  <form action="." method="get" class="goto-form">
  	<label for="goto-slide">Go to slide:</label>
  	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
  	<datalist id="goto-datalist"></datalist>
  	<input type="submit" value="Go">
  </form>
  
  <!-- deck.hash snippet -->
  <a href="." title="Permalink to this slide" class="deck-permalink">#</a>
  
  
  <!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/frameworks/deckjs/jquery-1.7.min.js"><\/script>')</script>
  
  <!-- Add Slide Class to Build Elements -->
  <script type='text/javascript'>
  $('ol.build li').addClass('slide')
  $('ul.build li').addClass('slide')
  </script>
  
  <!-- Deck Core and extensions -->
  <script src="libraries/frameworks/deckjs/core/deck.core.js"></script>
  <script src="libraries/frameworks/deckjs/extensions/goto/deck.goto.js"></script>
<script src="libraries/frameworks/deckjs/extensions/hash/deck.hash.js"></script>
<script src="libraries/frameworks/deckjs/extensions/menu/deck.menu.js"></script>
<script src="libraries/frameworks/deckjs/extensions/navigation/deck.navigation.js"></script>
<script src="libraries/frameworks/deckjs/extensions/scale/deck.scale.js"></script>
<script src="libraries/frameworks/deckjs/extensions/status/deck.status.js"></script>
<!-- Initialize the deck -->
  <script>
  $(function() {
  	$.deck('.slide');
  });
  </script>  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script> -->
<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
<script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- DONE LOADING HIGHLIGHTER JS FILES -->
 

</html>
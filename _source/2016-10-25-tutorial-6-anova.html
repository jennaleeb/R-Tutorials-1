<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  
<html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<title>Tutorial 6 - Comparing several means (ANOVA)</title>
	<meta name="description" content="Tutorial 6 - Comparing several means (ANOVA)">
	<meta name="author" content="Jenna Blumenthal">
	<meta name="generator" content="slidify" />
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Required stylesheet -->
	<link rel="stylesheet" href="libraries/frameworks/deckjs/core/deck.core.css">
	<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/goto/deck.goto.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/hash/deck.hash.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/menu/deck.menu.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/navigation/deck.navigation.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/scale/deck.scale.css">
<link rel="stylesheet" href="libraries/frameworks/deckjs/extensions/status/deck.status.css">
<!-- Style theme. More available in /themes/style/  -->
	<link rel="stylesheet" href="libraries/frameworks/deckjs/themes/style/swiss.css">
	
	<!-- Transition theme. More available in /themes/transition/  -->
	<link rel="stylesheet" href="libraries/frameworks/deckjs/themes/transition/horizontal-slide.css">
	<script src="libraries/frameworks/deckjs/modernizr.custom.js"></script>
	
	<!-- LOAD STYLE SHEETS -->
	<link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css">
	
	  
</head>

<body class="deck-container">

  <!-- Begin slides -->
  <section class="slide " id="slide-1">
  <h2>Comparing Several Means: ANOVA</h2>
  <p><strong>Jenna Blumenthal</strong><br>
   Tutorial #: 6<br>
   MIE 1402</p>

</section>
<section class="slide " id="slide-2">
  <h2>ANOVA as an omnibus test</h2>
  <ul>
<li><p>Allows us to compare the means of three or more groups without inflating the error (see <em>Field</em>, pg 399)  </p>

<p><strong>Eg inflating the error:</strong></p>

<ul>
<li>Suppose we consider the safety of a drug in terms of the occurrences of different types of side effects. As more types of side effects are considered, it becomes more likely that the new drug will appear to be less safe than existing drugs in terms of at least one side effect <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">Wikipedia</a></li>
</ul></li>
<li><p>Produces an \(F\)-statistic, which compares the systematic variance to the unsystematic variance</p>

<ul>
<li>&quot;is the \(explained\, variance\) \(>\) \(unexplained\, variance\), overall?&quot;</li>
</ul></li>
</ul>

</section>
<section class="slide " id="slide-3">
  <h2>ANOVA as Regression</h2>
  <ul>
<li>Both just configurations of the General Linear Model (GLM)</li>
<li>How well does our model (individual groupings) predict the data, compared to the error?

<ul>
<li>This is the same as: are our groups significantly different?</li>
<li>Regression with a categorial predictor variable</li>
</ul></li>
</ul>

</section>
<section class="slide " id="slide-4">
  <h3>Data we are using:</h3>
  <ul>
<li><a href="https://studysites.sagepub.com/dsur/study/articles.htm">https://studysites.sagepub.com/dsur/study/articles.htm</a></li>
</ul>

<style type="text/css">
.deck-container td { padding: 5px 20px}
</style>

<table><thead>
<tr>
<th align="right">person</th>
<th align="left">dose</th>
<th align="right">libido</th>
</tr>
</thead><tbody>
<tr>
<td align="right">1</td>
<td align="left">Placebo</td>
<td align="right">3</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">Placebo</td>
<td align="right">2</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">Placebo</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">Placebo</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">5</td>
<td align="left">Placebo</td>
<td align="right">4</td>
</tr>
<tr>
<td align="right">6</td>
<td align="left">Low Dose</td>
<td align="right">5</td>
</tr>
<tr>
<td align="right">7</td>
<td align="left">Low Dose</td>
<td align="right">2</td>
</tr>
<tr>
<td align="right">8</td>
<td align="left">Low Dose</td>
<td align="right">4</td>
</tr>
<tr>
<td align="right">9</td>
<td align="left">Low Dose</td>
<td align="right">2</td>
</tr>
<tr>
<td align="right">10</td>
<td align="left">Low Dose</td>
<td align="right">3</td>
</tr>
<tr>
<td align="right">11</td>
<td align="left">High Dose</td>
<td align="right">7</td>
</tr>
<tr>
<td align="right">12</td>
<td align="left">High Dose</td>
<td align="right">4</td>
</tr>
<tr>
<td align="right">13</td>
<td align="left">High Dose</td>
<td align="right">5</td>
</tr>
<tr>
<td align="right">14</td>
<td align="left">High Dose</td>
<td align="right">3</td>
</tr>
<tr>
<td align="right">15</td>
<td align="left">High Dose</td>
<td align="right">6</td>
</tr>
</tbody></table>

</section>
<section class="slide " id="slide-5">
  <h2>ANOVA as Regression</h2>
  <ul>
<li>Does dose (placebo, low or high) predict libido? (regression-speak)</li>
<li>Can also say: is libido in these 3 groups significantly different? (ANOVA-speak)</li>
</ul>

<p><img src="assets/fig/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4"></p>

</section>
<section class="slide " id="slide-6">
  <h2>ANOVA as Regression</h2>
  <ul>
<li>If our predictor variable (dose) has 3 ordered levels (placebo, low dose, high dose)</li>
</ul>

<p>We can set our regression equation to:</p>

<p>\(libido_{i} = b_{0} + b_{2high_{i}} + b_{1low_{i}} + \epsilon_{i}\)</p>

<p>Where:</p>

<p>\(b_0 = \overline{X}_{placebo}\)<br>
\(b_1 = \overline{X}_{low dose} - \overline{X}_{placebo}\)<br>
\(b_2 = \overline{X}_{high dose} - \overline{X}_{placebo}\)   </p>

<ul>
<li>We are asking: Does using group means to predict libido scores perform better than using the overall mean?</li>
</ul>

</section>
<section class="slide " id="slide-7">
  <h3>Try this yourself:</h3>
  <pre><code class="r">lm.1 &lt;- lm(libido ~ dose, data = data)
</code></pre>

<ul>
<li>calculate the means of each dose group</li>
<li>prove to yourself that regression = ANOVA = GLM</li>
</ul>

</section>
<section class="slide " id="slide-8">
  <h2>ANOVA as Regression</h2>
  <p>Moral of the story: ANOVA can always be represented by the multiple regression equation in which the # of predictor variables is one <strong>less</strong> than the # of categories of the independent variable.</p>

<p><img src="assets/fig/unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7"></p>

</section>
<section class="slide " id="slide-9">
  <h2>ANOVA in R</h2>
  <pre><code class="r">viagraModel &lt;- aov(libido ~ dose, data = data)
summary(viagraModel)
</code></pre>

<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## dose         2  20.13  10.067   5.119 0.0247 *
## Residuals   12  23.60   1.967                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<ul>
<li>First row: \(SS_{M} = 20.13\) (model)</li>
<li>Second row \(SS_{R} = 23.60\) (error)</li>
<li>\(F\) value: ratio of \(MS_{M}/MS_{R}\)</li>
</ul>

</section>
<section class="slide " id="slide-10">
  <h2>Planned contrasts</h2>
  <ul>
<li>\(F\)-ratio does not tell us where differences between groups lie</li>
<li><p>Two approaches:</p></li>
<li><p><strong>Planned contrasts:</strong> break down variance accounted for by the model into component parts (specific hypothesis)  </p>

<ul>
<li>Not going to go into the theory today, but I highly recommend <em>Field</em> 419-424. This is one of those times where looking through the math helps.</li>
</ul></li>
<li><p><strong>Post hoc tests:</strong> compare every group but use a stricter acceptance criterion (no specific hypothesis)  </p></li>
</ul>

</section>
<section class="slide " id="slide-11">
  <h2>Built-in planned contrasts in R</h2>
  <ul>
<li>R actually sets default constrasts for your grouping variable</li>
</ul>

<pre><code class="r">summary.lm(viagraModel)
</code></pre>

<pre><code>## 
## Call:
## aov(formula = libido ~ dose, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##   -2.0   -1.2   -0.2    0.9    2.0 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)     2.2000     0.6272   3.508  0.00432 **
## doseLow Dose    1.0000     0.8869   1.127  0.28158   
## doseHigh Dose   2.8000     0.8869   3.157  0.00827 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.402 on 12 degrees of freedom
## Multiple R-squared:  0.4604, Adjusted R-squared:  0.3704 
## F-statistic: 5.119 on 2 and 12 DF,  p-value: 0.02469
</code></pre>

</section>
<section class="slide " id="slide-12">
  
  <ul>
<li>Compares each group to the base (first) group

<ul>
<li>Is each dose signficantly different than the placebo?</li>
</ul></li>
</ul>

<pre><code class="r">contrasts(data$dose)
</code></pre>

<pre><code>##           Low Dose High Dose
## Placebo          0         0
## Low Dose         1         0
## High Dose        0         1
</code></pre>

<ul>
<li>If we wanted to set our own contrasts

<ul>
<li>e.g. is any viagra (low or high) significantly different than the placebo, and are high and low doses different from each other?</li>
</ul></li>
</ul>

<pre><code class="r">contrast_1 &lt;- c(-2,1,1) # placebo vs viagra
contrast_2 &lt;- c(0,-1,1) # high vs low

contrasts(data$dose) &lt;- cbind(contrast_1, contrast_2)
</code></pre>

<pre><code>##           contrast_1 contrast_2
## Placebo           -2          0
## Low Dose           1         -1
## High Dose          1          1
</code></pre>

</section>
<section class="slide " id="slide-13">
  <h2>More complex ANOVAs</h2>
  <p><img src="assets/fig/anova_naming.jpg" alt=""></p>

</section>
<section class="slide " id="slide-14">
  <h2>More complex ANOVAs</h2>
  <ul>
<li><p>Benefit of using ANOVA is you can look at the effect of more than one independent variable, and how they interact</p>

<ul>
<li>Main effects</li>
<li>Interaction effects</li>
</ul></li>
<li><p>In R:</p></li>
</ul>

<pre><code class="r">aov_model &lt;- aov(outcome ~ predictor1*predictor2, data = data_frame)
</code></pre>

</section>
<section class="slide " id="slide-15">
  <h2>References</h2>
  <p>Field A, Miles J, Field Z. Discovering Statistics Using R. London: Sage; 2012.</p>

<p><a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">https://en.wikipedia.org/wiki/Multiple_comparisons_problem</a></p>

</section>
</body>
  <!-- deck.navigation snippet -->
  <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
  <a href="#" class="deck-next-link" title="Next">&#8594;</a>
  
  <!-- deck.status snippet -->
  <p class="deck-status">
  <span class="deck-status-current"></span>
    /
  <span class="deck-status-total"></span>
  </p>
  
  <!-- deck.goto snippet -->
  <form action="." method="get" class="goto-form">
  	<label for="goto-slide">Go to slide:</label>
  	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
  	<datalist id="goto-datalist"></datalist>
  	<input type="submit" value="Go">
  </form>
  
  <!-- deck.hash snippet -->
  <a href="." title="Permalink to this slide" class="deck-permalink">#</a>
  
  
  <!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/frameworks/deckjs/jquery-1.7.min.js"><\/script>')</script>
  
  <!-- Add Slide Class to Build Elements -->
  <script type='text/javascript'>
  $('ol.build li').addClass('slide')
  $('ul.build li').addClass('slide')
  </script>
  
  <!-- Deck Core and extensions -->
  <script src="libraries/frameworks/deckjs/core/deck.core.js"></script>
  <script src="libraries/frameworks/deckjs/extensions/goto/deck.goto.js"></script>
<script src="libraries/frameworks/deckjs/extensions/hash/deck.hash.js"></script>
<script src="libraries/frameworks/deckjs/extensions/menu/deck.menu.js"></script>
<script src="libraries/frameworks/deckjs/extensions/navigation/deck.navigation.js"></script>
<script src="libraries/frameworks/deckjs/extensions/scale/deck.scale.js"></script>
<script src="libraries/frameworks/deckjs/extensions/status/deck.status.js"></script>
<!-- Initialize the deck -->
  <script>
  $(function() {
  	$.deck('.slide');
  });
  </script>  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script> -->
<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
<script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- DONE LOADING HIGHLIGHTER JS FILES -->
 

</html>